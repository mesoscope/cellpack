

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>cellpack.autopack.upy.simularium.simularium_helper &mdash; cellPack 1.0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> cellPack
          

          
          </a>

          
            
            
              <div class="version">
                1.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#stable-release">Stable release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../installation.html#from-sources">From sources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../modules.html">Package modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../cellpack.html">cellpack package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../cellpack.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../cellpack.autopack.html">cellpack.autopack package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../cellpack.bin.html">cellpack.bin package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../cellpack.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../cellpack.html#module-cellpack.example">cellpack.example module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../cellpack.html#module-cellpack">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../recipe-schema.html">Cellpack Recipe Schema 1.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../recipe-schema.html#recipe-definition-properties">Recipe definition properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#name">name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#version">version</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../recipe-schema.html#example">example:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../recipe-schema.html#options-properties">Options properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#saveresult">saveResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#resultfile">resultfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#enviroonly">EnviroOnly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#canceldialog">cancelDialog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#pickweightedingr">pickWeightedIngr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#pickrandpt">pickRandPt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#ingrlookforneighbours">ingrLookForNeighbours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#overwriteplacemethod">overwritePlaceMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#boundingbox">boundingBox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#smallestproteinsize">smallestProteinSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#largestproteinsize">largestProteinSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#computegridparams">computeGridParams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#windowssize">windowsSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#runtimedisplay">runTimeDisplay</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#placemethod">placeMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#use-gradient">use_gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#gradients">gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#innergridmethod">innerGridMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#freeptsupdatethreshold">freePtsUpdateThreshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#use-periodicity">use_periodicity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#timer">_timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#hackfreepts">_hackFreepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../recipe-schema.html#example-options">example <code class="docutils literal notranslate"><span class="pre">Options</span></code>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../recipe-schema.html#ingredient-properties">Ingredient Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#id81">name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#molarity">molarity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#nbmol">nbMol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#encapsulatingradius">encapsulatingRadius</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#radii">radii</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#positions">positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#positions2">positions2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#spherefile">sphereFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#packingpriority">packingPriority</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#pdb">pdb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#color">color</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#meshfile">meshFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#meshname">meshName</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#coordsystem">coordsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#principalvector">principalVector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#type">Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#offset">offset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#jittermax">jitterMax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#nbjitter">nbJitter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#perturbaxisamplitude">perturbAxisAmplitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#userotaxis">useRotAxis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#rotaxis">rotAxis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#rotrange">rotRange</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#useorientbias">useOrientBias</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#orientbiasrotrangemin">orientBiasRotRangeMin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#orientbiasrotrangemax">orientBiasRotRangeMax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#cutoff-boundary">cutoff_boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#cutoff-surface">cutoff_surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#placetype">placeType</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#rejectionthreshold">rejectionThreshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#packingmode">packingMode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#gradient">gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#proba-binding">proba_binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#proba-not-binding">proba_not_binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#isattractor">isAttractor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#weight">weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#partners-name">partners_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#excluded-partners-name">excluded_partners_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#partners-position">partners_position</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#partners-weight">partners_weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#properties">properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#score">score</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#organism">organism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../recipe-schema.html#example-ingredient">example ingredient</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../contributing.html#deploying">Deploying</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">cellPack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../../../cellpack.html">cellpack</a> &raquo;</li>
        
          <li><a href="../../../autopack.html">cellpack.autopack</a> &raquo;</li>
        
          <li><a href="../../upy.html">cellpack.autopack.upy</a> &raquo;</li>
        
      <li>cellpack.autopack.upy.simularium.simularium_helper</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for cellpack.autopack.upy.simularium.simularium_helper</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># standardmodule</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">trimesh</span>

<span class="kn">from</span> <span class="nn">simulariumio</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TrajectoryConverter</span><span class="p">,</span>
    <span class="n">TrajectoryData</span><span class="p">,</span>
    <span class="n">AgentData</span><span class="p">,</span>
    <span class="n">UnitData</span><span class="p">,</span>
    <span class="n">MetaData</span><span class="p">,</span>
    <span class="n">CameraData</span><span class="p">,</span>
    <span class="n">DisplayData</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">simulariumio.cellpack</span> <span class="kn">import</span> <span class="n">CellpackConverter</span><span class="p">,</span> <span class="n">HAND_TYPE</span>
<span class="kn">from</span> <span class="nn">simulariumio.constants</span> <span class="kn">import</span> <span class="n">DISPLAY_TYPE</span><span class="p">,</span> <span class="n">VIZ_TYPE</span>

<span class="kn">from</span> <span class="nn">cellpack.autopack.upy</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">hostHelper</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">import</span> <span class="nn">collada</span>


<div class="viewcode-block" id="Instance"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.Instance">[docs]</a><span class="k">class</span> <span class="nc">Instance</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">instance_id</span><span class="p">,</span> <span class="n">unique_id</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">viz_type</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instance_id</span> <span class="o">=</span> <span class="n">instance_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">unique_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">isinstance</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_static</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viz_type</span> <span class="o">=</span> <span class="n">viz_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span>

<div class="viewcode-block" id="Instance.set_static"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.Instance.set_static">[docs]</a>    <span class="k">def</span> <span class="nf">set_static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_static</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_points</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_static</span> <span class="o">=</span> <span class="n">is_static</span>
        <span class="k">if</span> <span class="n">is_static</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">viz_type</span> <span class="o">==</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">FIBER</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">static_sub_points</span> <span class="o">=</span> <span class="n">sub_points</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">static_position</span> <span class="o">=</span> <span class="n">position</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">static_rotation</span> <span class="o">=</span> <span class="n">rotation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">static_position</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">static_rotation</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">static_sub_points</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Instance.move"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.Instance.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_point</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_points</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">viz_type</span> <span class="o">==</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">FIBER</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_mapping</span><span class="p">[</span><span class="n">time_point</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;sub_points&quot;</span><span class="p">:</span> <span class="n">sub_points</span><span class="p">,</span>
                <span class="s2">&quot;n_subpoints&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_points</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">euler</span> <span class="o">=</span> <span class="n">CellpackConverter</span><span class="o">.</span><span class="n">_get_euler_from_matrix</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="n">HAND_TYPE</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_mapping</span><span class="p">[</span><span class="n">time_point</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="n">position</span><span class="p">,</span> <span class="s2">&quot;rotation&quot;</span><span class="p">:</span> <span class="n">euler</span><span class="p">}</span></div>

<div class="viewcode-block" id="Instance.increment_static"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.Instance.increment_static">[docs]</a>    <span class="k">def</span> <span class="nf">increment_static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_point</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_static</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">viz_type</span> <span class="o">==</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">FIBER</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time_mapping</span><span class="p">[</span><span class="n">time_point</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;sub_points&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_sub_points</span><span class="p">,</span>
                    <span class="s2">&quot;n_subpoints&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">static_sub_points</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time_mapping</span><span class="p">[</span><span class="n">time_point</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_position</span><span class="p">,</span>
                    <span class="s2">&quot;rotation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">static_rotation</span><span class="p">,</span>
                <span class="p">}</span></div></div>


<div class="viewcode-block" id="simulariumHelper"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper">[docs]</a><span class="k">class</span> <span class="nc">simulariumHelper</span><span class="p">(</span><span class="n">hostHelper</span><span class="o">.</span><span class="n">Helper</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Simularium helper abstract class</span>
<span class="sd">    ============================</span>
<span class="sd">        This is the Simularium helper Object. The helper</span>
<span class="sd">        give access to the basic function need for create and edit a host 3d object and scene.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># this id can probably found in c4d.symbols</span>
    <span class="c1"># TAG ID</span>
    <span class="n">DATABASE</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/mesoscope/cellPACK_data/master/cellPACK_database_1.1.0&quot;</span>
    <span class="n">SPLINE</span> <span class="o">=</span> <span class="s2">&quot;kNurbsCurve&quot;</span>
    <span class="n">INSTANCE</span> <span class="o">=</span> <span class="s2">&quot;Simularium.Geom&quot;</span>
    <span class="n">EMPTY</span> <span class="o">=</span> <span class="s2">&quot;Simularium.Geom&quot;</span>
    <span class="n">SPHERE</span> <span class="o">=</span> <span class="s2">&quot;Simularium.Spheres&quot;</span>
    <span class="n">POLYGON</span> <span class="o">=</span> <span class="s2">&quot;Simularium.IndexedPolygons&quot;</span>
    <span class="c1"># msutil = om.MScriptUtil()</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">VERBOSE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">viewer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">host</span> <span class="o">=</span> <span class="s2">&quot;simularium&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vi</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">hostHelper</span><span class="o">.</span><span class="n">Helper</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># we can define here some function alias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nogui</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dict of instances in the scene</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent_id_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">10.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span> <span class="o">=</span> <span class="s2">&quot;nogui&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nogui</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hext</span> <span class="o">=</span> <span class="s2">&quot;dae&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_fiber_length</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="simulariumHelper.clear"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></div>

<div class="viewcode-block" id="simulariumHelper.updateAppli"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.updateAppli">[docs]</a>    <span class="k">def</span> <span class="nf">updateAppli</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.Cube"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Cube">[docs]</a>    <span class="k">def</span> <span class="nf">Cube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.Box"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Box">[docs]</a>    <span class="k">def</span> <span class="nf">Box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.Polylines"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Polylines">[docs]</a>    <span class="k">def</span> <span class="nf">Polylines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="simulariumHelper.Spheres"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Spheres">[docs]</a>    <span class="k">def</span> <span class="nf">Spheres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.Cylinders"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Cylinders">[docs]</a>    <span class="k">def</span> <span class="nf">Cylinders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cylinder</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.Geom"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Geom">[docs]</a>    <span class="k">def</span> <span class="nf">Geom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.Labels"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Labels">[docs]</a>    <span class="k">def</span> <span class="nf">Labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.IndexedPolygons"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.IndexedPolygons">[docs]</a>    <span class="k">def</span> <span class="nf">IndexedPolygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.setViewer"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.setViewer">[docs]</a>    <span class="k">def</span> <span class="nf">setViewer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vi</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span> <span class="o">=</span> <span class="n">vi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">AddObject</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">Labels</span></div>

<div class="viewcode-block" id="simulariumHelper.getCurrentScene"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getCurrentScene">[docs]</a>    <span class="k">def</span> <span class="nf">getCurrentScene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span></div>

<div class="viewcode-block" id="simulariumHelper.progressBar"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.progressBar">[docs]</a>    <span class="k">def</span> <span class="nf">progressBar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;update the progress bar status by progress value and label string</span>
<span class="sd">        @type  progress: Int/Float</span>
<span class="sd">        @param progress: the new progress</span>
<span class="sd">        @type  label: string</span>
<span class="sd">        @param label: the new message to put in the progress status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># resetProgressBar</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Progress &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">progress</span><span class="p">),</span> <span class="n">label</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="simulariumHelper.resetProgressBar"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.resetProgressBar">[docs]</a>    <span class="k">def</span> <span class="nf">resetProgressBar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;reset the Progress Bar, using value&quot;&quot;&quot;</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="simulariumHelper.update"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment_time</span><span class="p">()</span></div>

<div class="viewcode-block" id="simulariumHelper.getType"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getType">[docs]</a>    <span class="k">def</span> <span class="nf">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="vm">__module__</span></div>

<div class="viewcode-block" id="simulariumHelper.getMesh"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMesh">[docs]</a>    <span class="k">def</span> <span class="nf">getMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span> <span class="o">==</span> <span class="s2">&quot;nogui&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">()</span><span class="o">.</span><span class="n">findGeomsByName</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">m</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.getName"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getName">[docs]</a>    <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span> <span class="o">==</span> <span class="s2">&quot;nogui&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">()</span><span class="o">.</span><span class="n">findGeomsByName</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span></div>

<div class="viewcode-block" id="simulariumHelper.increment_static_objects"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.increment_static_objects">[docs]</a>    <span class="k">def</span> <span class="nf">increment_static_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">is_static</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">increment_static</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.set_object_static"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.set_object_static">[docs]</a>    <span class="k">def</span> <span class="nf">set_object_static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">set_static</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.increment_time"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.increment_time">[docs]</a>    <span class="k">def</span> <span class="nf">increment_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment_static_objects</span><span class="p">()</span></div>

<div class="viewcode-block" id="simulariumHelper.move_object"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.move_object">[docs]</a>    <span class="k">def</span> <span class="nf">move_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_points</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increment_time</span><span class="p">()</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">sub_points</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.place_object"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.place_object">[docs]</a>    <span class="k">def</span> <span class="nf">place_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sub_points</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">sub_points</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.getObject"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getObject">[docs]</a>    <span class="k">def</span> <span class="nf">getObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.getChilds"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getChilds">[docs]</a>    <span class="k">def</span> <span class="nf">getChilds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span></div>

<div class="viewcode-block" id="simulariumHelper.deleteObject"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.deleteObject">[docs]</a>    <span class="k">def</span> <span class="nf">deleteObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">vi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;isinstance&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteInstance</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">vi</span><span class="o">.</span><span class="n">RemoveObject</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;problem deleting &quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.newEmpty"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.newEmpty">[docs]</a>    <span class="k">def</span> <span class="nf">newEmpty</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parentCenter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span>
    <span class="p">):</span>
        <span class="c1"># empty = Geom(name, visible=display)</span>
        <span class="c1"># if location is not None:</span>
        <span class="c1">#     if parentCenter is not None:</span>
        <span class="c1">#         location = location - parentCenter</span>
        <span class="c1">#     empty.SetTranslation(np.array(location))</span>
        <span class="c1"># parent = None</span>
        <span class="c1"># if &quot;parent&quot; in kw:</span>
        <span class="c1">#     parent = kw[&quot;parent&quot;]</span>
        <span class="c1"># self.addObjectToScene(None, empty, parent=parent)</span>
        <span class="c1"># return empty</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.updateMasterInstance"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.updateMasterInstance">[docs]</a>    <span class="k">def</span> <span class="nf">updateMasterInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">newMesh</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="c1"># get the instancematrix frommaster</span>
        <span class="c1"># apply them to new newMesh</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.deleteInstance"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.deleteInstance">[docs]</a>    <span class="k">def</span> <span class="nf">deleteInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="c1"># pop the instance from the instanceMatrice</span>
        <span class="c1"># delete the object</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">instanceMatricesFortran</span><span class="p">[:]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1">#        m.pop(instance.id)</span>
        <span class="n">matrice</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">m</span><span class="p">]</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">instanceMatrices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrice</span><span class="p">))</span>
        <span class="k">del</span> <span class="n">instance</span></div>

<div class="viewcode-block" id="simulariumHelper.add_new_instance_and_update_time"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.add_new_instance_and_update_time">[docs]</a>    <span class="k">def</span> <span class="nf">add_new_instance_and_update_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">ingredient</span><span class="p">,</span>
        <span class="n">instance_id</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sub_points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent_id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;Grow&quot;</span> <span class="ow">or</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;Actine&quot;</span><span class="p">:</span>
            <span class="n">viz_type</span> <span class="o">=</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">FIBER</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">viz_type</span> <span class="o">=</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">DEFAULT</span>
        <span class="n">new_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">instance_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agent_id_counter</span><span class="p">,</span>
            <span class="n">ingredient</span><span class="o">.</span><span class="n">encapsulatingRadius</span><span class="p">,</span>
            <span class="n">viz_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="n">instance_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move_object</span><span class="p">(</span><span class="n">instance_id</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">sub_points</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.add_instance"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.add_instance">[docs]</a>    <span class="k">def</span> <span class="nf">add_instance</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">ingredient</span><span class="p">,</span>
        <span class="n">instance_id</span><span class="p">,</span>
        <span class="n">radius</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sub_points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent_id_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">ingredient</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fiber</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span><span class="p">):</span>
            <span class="n">viz_type</span> <span class="o">=</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">FIBER</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">viz_type</span> <span class="o">=</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">DEFAULT</span>

        <span class="n">new_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">instance_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agent_id_counter</span><span class="p">,</span>
            <span class="n">radius</span><span class="p">,</span>
            <span class="n">viz_type</span><span class="p">,</span>
            <span class="n">mesh</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="n">instance_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_instance</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sub_points</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">place_object</span><span class="p">(</span><span class="n">instance_id</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">sub_points</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.setObjectMatrix"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.setObjectMatrix">[docs]</a>    <span class="k">def</span> <span class="nf">setObjectMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">matrice</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;transpose&quot;</span> <span class="ow">in</span> <span class="n">kw</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="s2">&quot;isinstance&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kw</span><span class="p">[</span><span class="s2">&quot;transpose&quot;</span><span class="p">]:</span>
                <span class="n">matrice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrice</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="nb">object</span><span class="o">.</span><span class="n">SetTransformation</span><span class="p">(</span><span class="n">matrice</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.concatObjectMatrix"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.concatObjectMatrix">[docs]</a>    <span class="k">def</span> <span class="nf">concatObjectMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.GetAbsPosUntilRoot"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.GetAbsPosUntilRoot">[docs]</a>    <span class="k">def</span> <span class="nf">GetAbsPosUntilRoot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span></div>

<div class="viewcode-block" id="simulariumHelper.add_compartment_to_scene"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.add_compartment_to_scene">[docs]</a>    <span class="k">def</span> <span class="nf">add_compartment_to_scene</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">compartment</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">SPHERE</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="n">compartment</span><span class="o">.</span><span class="n">encapsulatingRadius</span>
        <span class="k">if</span> <span class="n">compartment</span><span class="o">.</span><span class="n">meshType</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">compartment</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s2">&quot;.obj&quot;</span><span class="p">:</span>
                <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">OBJ</span>
                <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">compartment</span><span class="o">.</span><span class="n">path</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">compartment</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
                    <span class="k">else</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">compartment</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_data</span><span class="p">[</span><span class="n">compartment</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisplayData</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">compartment</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">display_type</span><span class="o">=</span><span class="n">display_type</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span>
            <span class="n">compartment</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">compartment</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
            <span class="n">radius</span><span class="p">,</span>
            <span class="n">compartment</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.add_object_to_scene"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.add_object_to_scene">[docs]</a>    <span class="k">def</span> <span class="nf">add_object_to_scene</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doc</span><span class="p">,</span>
        <span class="n">ingredient</span><span class="p">,</span>
        <span class="n">instance_id</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">rotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">control_points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">SPHERE</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fiber</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fiber_length</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_fiber_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span>
            <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">FIBER</span>
        <span class="k">elif</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;SingleCube&quot;</span><span class="p">:</span>
            <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">CUBE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_data</span><span class="p">[</span><span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisplayData</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">display_type</span><span class="o">=</span><span class="n">display_type</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">control_points</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_new_instance_and_update_time</span><span class="p">(</span>
            <span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="n">instance_id</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">control_points</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.update_instance_positions_and_rotations"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.update_instance_positions_and_rotations">[docs]</a>    <span class="k">def</span> <span class="nf">update_instance_positions_and_rotations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">objects</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">instance_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">ptInd</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">place_object</span><span class="p">(</span><span class="n">instance_id</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.get_display_data"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.get_display_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_display_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">):</span>
        <span class="n">ingr_name</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">name</span>
        <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">SPHERE</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;SingleCube&quot;</span><span class="p">:</span>
            <span class="n">display_type</span> <span class="o">=</span> <span class="s2">&quot;CUBE&quot;</span>
        <span class="k">elif</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s2">&quot;SingleSphere&quot;</span><span class="p">:</span>
            <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">SPHERE</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fiber</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span><span class="p">):</span>
            <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">FIBER</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pdb_file_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">PDB</span>
            <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s2">&quot;pdb&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pdb_file_name</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s2">&quot;pdb&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">pdb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;.map&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">pdb</span><span class="p">:</span>
                <span class="n">pdb_file_name</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">pdb</span>
            <span class="k">elif</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_info</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">meshType</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_info</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_info</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="s2">&quot;file&quot;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">meshType</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_info</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">])</span>
                    <span class="n">file_name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">meshType</span> <span class="o">==</span> <span class="s2">&quot;raw&quot;</span><span class="p">:</span>
                    <span class="n">file_name</span> <span class="o">=</span> <span class="n">ingr_name</span>
                <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">simulariumHelper</span><span class="o">.</span><span class="n">DATABASE</span><span class="si">}</span><span class="s2">/geometries/</span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2">.obj&quot;</span>
                <span class="n">display_type</span> <span class="o">=</span> <span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">OBJ</span>
                <span class="k">return</span> <span class="n">display_type</span><span class="p">,</span> <span class="n">url</span>
            <span class="k">if</span> <span class="s2">&quot;.pdb&quot;</span> <span class="ow">in</span> <span class="n">pdb_file_name</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">simulariumHelper</span><span class="o">.</span><span class="n">DATABASE</span><span class="si">}</span><span class="s2">/other/</span><span class="si">{</span><span class="n">pdb_file_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">pdb_file_name</span>
        <span class="k">return</span> <span class="n">display_type</span><span class="p">,</span> <span class="n">url</span></div>

<div class="viewcode-block" id="simulariumHelper.is_fiber"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.is_fiber">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_fiber</span><span class="p">(</span><span class="n">ingr_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ingr_type</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;Grow&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Actine&quot;</span><span class="p">,</span>
            <span class="s2">&quot;MultiCylinders&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SingleCylinder&quot;</span><span class="p">,</span>
        <span class="p">]</span></div>

<div class="viewcode-block" id="simulariumHelper.init_scene_with_objects"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.init_scene_with_objects">[docs]</a>    <span class="k">def</span> <span class="nf">init_scene_with_objects</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">objects</span><span class="p">,</span>
        <span class="n">grid_point_positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">grid_point_compartment_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show_sphere_trees</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">position</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">ingr_name</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">name</span>
            <span class="n">sub_points</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fiber</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">Type</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">nbCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># TODO: get sub_points accurately</span>
                <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">nbCurve</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fiber_length</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">max_fiber_length</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">nbCurve</span>
                <span class="n">sub_points</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">listePtLinear</span>

            <span class="k">if</span> <span class="n">ingr_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_data</span><span class="p">:</span>
                <span class="n">display_type</span><span class="p">,</span> <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_display_data</span><span class="p">(</span><span class="n">ingredient</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">display_data</span><span class="p">[</span><span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisplayData</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">ingr_name</span><span class="p">,</span>
                    <span class="n">display_type</span><span class="o">=</span><span class="n">display_type</span><span class="p">,</span>
                    <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">to_hex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">color</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">encapsulatingRadius</span> <span class="k">if</span> <span class="n">ingredient</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">10</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">][</span><span class="s2">&quot;translate&quot;</span><span class="p">])</span>
            <span class="n">rot_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rotation</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">adj_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rot_mat</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
            <span class="n">adj_pos</span> <span class="o">=</span> <span class="n">position</span> <span class="o">-</span> <span class="n">adj_offset</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span>
                <span class="n">ingr_name</span><span class="p">,</span>
                <span class="n">ingredient</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ingr_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">ptInd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">radius</span><span class="p">,</span>
                <span class="n">adj_pos</span><span class="p">,</span>
                <span class="n">rotation</span><span class="p">,</span>
                <span class="n">sub_points</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">show_sphere_trees</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">positions</span><span class="p">)):</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">level</span><span class="p">])):</span>
                            <span class="n">pos</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">apply_rotation</span><span class="p">(</span>
                                <span class="n">rotation</span><span class="p">,</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">position</span>
                            <span class="p">)</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-spheres&quot;</span><span class="p">,</span>
                                <span class="n">ingredient</span><span class="p">,</span>
                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">ptInd</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="n">ingredient</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
                                <span class="n">pos</span><span class="p">,</span>
                                <span class="n">rotation</span><span class="p">,</span>
                                <span class="kc">None</span><span class="p">,</span>
                            <span class="p">)</span>

        <span class="k">if</span> <span class="n">grid_point_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grid_point_compartment_ids</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">compartment_id</span> <span class="o">=</span> <span class="n">grid_point_compartment_ids</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                    <span class="n">point_pos</span> <span class="o">=</span> <span class="n">grid_point_positions</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">compartment_id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;inside&quot;</span>
                    <span class="k">elif</span> <span class="n">compartment_id</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;surface&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;outside&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">display_data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisplayData</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">display_type</span><span class="o">=</span><span class="n">DISPLAY_TYPE</span><span class="o">.</span><span class="n">SPHERE</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                    <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span>
                        <span class="n">name</span><span class="p">,</span>
                        <span class="kc">None</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="mf">0.1</span><span class="p">,</span>
                        <span class="n">point_pos</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
                        <span class="kc">None</span><span class="p">,</span>
                    <span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.addCameraToScene"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.addCameraToScene">[docs]</a>    <span class="k">def</span> <span class="nf">addCameraToScene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.addLampToScene"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.addLampToScene">[docs]</a>    <span class="k">def</span> <span class="nf">addLampToScene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.reParent"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.reParent">[docs]</a>    <span class="k">def</span> <span class="nf">reParent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nogui</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">vi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vi</span> <span class="o">==</span> <span class="s2">&quot;nogui&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="p">[</span>
                <span class="n">vi</span><span class="o">.</span><span class="n">ReparentObject</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">parent</span><span class="p">,</span> <span class="n">objectRetainsCurrentPosition</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obj</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">viewer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">viewer</span> <span class="o">=</span> <span class="n">vi</span>
            <span class="n">vi</span><span class="o">.</span><span class="n">ReparentObject</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">objectRetainsCurrentPosition</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.setInstance"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.setInstance">[docs]</a>    <span class="k">def</span> <span class="nf">setInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.getTranslation"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getTranslation">[docs]</a>    <span class="k">def</span> <span class="nf">getTranslation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">centroid</span>  <span class="c1"># or getCumulatedTranslation</span></div>

<div class="viewcode-block" id="simulariumHelper.setTranslation"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.setTranslation">[docs]</a>    <span class="k">def</span> <span class="nf">setTranslation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">SetTranslation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FromVec</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span></div>

<div class="viewcode-block" id="simulariumHelper.translateObj"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.translateObj">[docs]</a>    <span class="k">def</span> <span class="nf">translateObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">use_parent</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">position</span>
        <span class="n">newPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FromVec</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_parent</span><span class="p">:</span>
            <span class="n">parentPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetAbsPosUntilRoot</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>  <span class="c1"># parent.GetAbsPos()</span>
            <span class="n">newPos</span> <span class="o">=</span> <span class="n">newPos</span> <span class="o">-</span> <span class="n">parentPos</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">ConcatTranslation</span><span class="p">(</span><span class="n">newPos</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.scaleObj"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.scaleObj">[docs]</a>    <span class="k">def</span> <span class="nf">scaleObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">sc</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">sc</span> <span class="o">=</span> <span class="p">[</span><span class="n">sc</span><span class="p">,</span> <span class="n">sc</span><span class="p">,</span> <span class="n">sc</span><span class="p">]</span>
        <span class="c1"># obj.scale = sc #SetScale()?</span>
        <span class="c1">#        obj.SetScale(np.array(sc))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span></div>

<div class="viewcode-block" id="simulariumHelper.rotateObj"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.rotateObj">[docs]</a>    <span class="k">def</span> <span class="nf">rotateObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">rot</span><span class="p">):</span>
        <span class="c1"># take radians, give degrees</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eulerToMatrix</span><span class="p">(</span><span class="n">rot</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>  <span class="c1"># obj.rotation</span></div>

<div class="viewcode-block" id="simulariumHelper.getTransformation"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getTransformation">[docs]</a>    <span class="k">def</span> <span class="nf">getTransformation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geom</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nogui</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">geom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetMatrix</span><span class="p">(</span><span class="n">geom</span><span class="o">.</span><span class="n">LastParentBeforeRoot</span><span class="p">())</span></div>

<div class="viewcode-block" id="simulariumHelper.toggleDisplay"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.toggleDisplay">[docs]</a>    <span class="k">def</span> <span class="nf">toggleDisplay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="n">display</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.getVisibility"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getVisibility">[docs]</a>    <span class="k">def</span> <span class="nf">getVisibility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">editor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">render</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># 0 off, 1#on, 2 undef</span>
        <span class="n">display</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">editor</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">render</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">active</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">display</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">GetEditorMode</span><span class="p">()]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">editor</span> <span class="ow">and</span> <span class="n">render</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">active</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">display</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">GetRenderMode</span><span class="p">()]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">editor</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">render</span> <span class="ow">and</span> <span class="n">active</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">906</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">display</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">GetEditorMode</span><span class="p">()],</span>
                <span class="n">display</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">GetRenderMode</span><span class="p">()],</span>
                <span class="nb">bool</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">906</span><span class="p">]),</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.getCurrentSelection"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getCurrentSelection">[docs]</a>    <span class="k">def</span> <span class="nf">getCurrentSelection</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the current/active selected object in the document or scene</span>
<span class="sd">        Simularium support only one object at a time.</span>
<span class="sd">        @rtype:   liste</span>
<span class="sd">        @return:  the list of selected object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">()</span><span class="o">.</span><span class="n">currentObject</span><span class="p">]</span></div>

    <span class="c1"># ####################MATERIALS FUNCTION########################</span>

<div class="viewcode-block" id="simulariumHelper.addMaterial"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.addMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">addMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">color</span></div>

<div class="viewcode-block" id="simulariumHelper.createTexturedMaterial"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.createTexturedMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">createTexturedMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.assignMaterial"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.assignMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">assignMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">texture</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">texture</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">texture</span><span class="o">=</span><span class="n">mat</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">mat</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.changeObjColorMat"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.changeObjColorMat">[docs]</a>    <span class="k">def</span> <span class="nf">changeObjColorMat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.getMaterialObject"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMaterialObject">[docs]</a>    <span class="k">def</span> <span class="nf">getMaterialObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
        <span class="k">pass</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.getMaterial"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">getMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mat</span></div>

<div class="viewcode-block" id="simulariumHelper.getAllMaterials"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getAllMaterials">[docs]</a>    <span class="k">def</span> <span class="nf">getAllMaterials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="simulariumHelper.getMaterialName"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMaterialName">[docs]</a>    <span class="k">def</span> <span class="nf">getMaterialName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.ObjectsSelection"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.ObjectsSelection">[docs]</a>    <span class="k">def</span> <span class="nf">ObjectsSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listeObjects</span><span class="p">,</span> <span class="n">typeSel</span><span class="o">=</span><span class="s2">&quot;new&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modify the current object selection.</span>

<span class="sd">        @type  listeObjects: list</span>
<span class="sd">        @param listeObjects: list of object to joins</span>
<span class="sd">        @type  typeSel: string</span>
<span class="sd">        @param listeObjects: type of modification: new,add,...</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

    <span class="c1">#        dic={&quot;add&quot;:c4d.SELECTION_ADD,&quot;new&quot;:c4d.SELECTION_NEW}</span>
    <span class="c1">#        sc = self.getCurrentScene()</span>
    <span class="c1">#        [sc.SetSelection(x,dic[typeSel]) for x in listeObjects]</span>

<div class="viewcode-block" id="simulariumHelper.oneCylinder"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.oneCylinder">[docs]</a>    <span class="k">def</span> <span class="nf">oneCylinder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">head</span><span class="p">,</span>
        <span class="n">tail</span><span class="p">,</span>
        <span class="n">instance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># if instance is None:</span>
        <span class="c1">#     stick = self.getObject(name)</span>
        <span class="c1">#     if stick is None:</span>
        <span class="c1">#         v = np.array([tail, head])</span>
        <span class="c1">#         f = np.arange(len(v))</span>
        <span class="c1">#         f.shape = (-1, 2)</span>
        <span class="c1">#         stick = Cylinders(</span>
        <span class="c1">#             name, inheritMaterial=False, vertices=v, faces=f, radii=[1]</span>
        <span class="c1">#         )</span>
        <span class="c1">#         # stick = self.Cylinder(name,length=lenght,pos =head)</span>
        <span class="c1">#         self.addObjectToScene(self.getCurrentScene(), stick, parent=parent)</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         v = np.array([tail, head])</span>
        <span class="c1">#         f = np.arange(len(v))</span>
        <span class="c1">#         f.shape = (-1, 2)</span>
        <span class="c1">#         stick.Set(vertices=v, faces=f, redo=1)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     stick = instance</span>
        <span class="c1">#     v = instance.vertexSet.vertices.array</span>
        <span class="c1">#     i = len(v)</span>
        <span class="c1">#     #            v = np.concatenate((v,np.array([head,tail])))</span>
        <span class="c1">#     instance.vertexSet.vertices.AddValues([head, tail])</span>
        <span class="c1">#     instance.faceSet.faces.AddValues([i, i + 1])</span>
        <span class="c1">#     r = instance.vertexSet.radii.array[0]</span>
        <span class="c1">#     instance.vertexSet.radii.AddValues(r)</span>
        <span class="c1">#     instance.Set(redo=1)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.cylinder"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.cylinder">[docs]</a>    <span class="k">def</span> <span class="nf">cylinder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">length</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kw</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1">#        QualitySph={&quot;0&quot;:16,&quot;1&quot;:3,&quot;2&quot;:4,&quot;3&quot;:8,&quot;4&quot;:16,&quot;5&quot;:32}</span>
        <span class="k">if</span> <span class="s2">&quot;axis&quot;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kw</span><span class="p">[</span><span class="s2">&quot;axis&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s2">&quot;axis&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="n">principal_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">length</span> <span class="o">*</span> <span class="n">axis</span><span class="p">)</span>

        <span class="n">control_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pos</span><span class="p">,</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">principal_vector</span><span class="p">])</span>

        <span class="n">baseCyl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cylinders</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">radii</span><span class="o">=</span><span class="p">[</span><span class="n">radius</span><span class="p">],</span>
            <span class="n">inheritMaterial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">quality</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
            <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_object_to_scene</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">baseCyl</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="n">control_points</span><span class="o">=</span><span class="n">control_points</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setTranslation</span><span class="p">(</span><span class="n">baseCyl</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">baseCyl</span><span class="p">,</span> <span class="n">baseCyl</span><span class="p">]</span></div>

<div class="viewcode-block" id="simulariumHelper.updateTubeMesh"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.updateTubeMesh">[docs]</a>    <span class="k">def</span> <span class="nf">updateTubeMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">cradius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="c1"># change the radius to cradius</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#        mesh=geom.mesh.GetDown()#should be the cylinder</span>
        <span class="c1"># mesh[5000]=cradius</span>
        <span class="c1">#        cradius = cradius*1/0.2</span>
        <span class="c1"># should used current Y scale too</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">radii</span><span class="o">=</span><span class="p">[</span><span class="n">cradius</span><span class="p">],</span> <span class="n">quality</span><span class="o">=</span><span class="n">quality</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.sphere"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.sphere">[docs]</a>    <span class="k">def</span> <span class="nf">sphere</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">baseSphere</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Spheres</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">radii</span><span class="o">=</span><span class="p">[</span>
                <span class="n">radius</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">centers</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]],</span>
            <span class="n">quality</span><span class="o">=</span><span class="n">res</span><span class="p">,</span>
            <span class="n">inheritMaterial</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">mat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMaterial</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assignMaterial</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">baseSphere</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># color = [1.,1.,0.]</span>
                <span class="n">baseSphere</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span>
                    <span class="n">materials</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">color</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_object_to_scene</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseSphere</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setTranslation</span><span class="p">(</span><span class="n">baseSphere</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">baseSphere</span><span class="p">,</span> <span class="n">baseSphere</span><span class="p">]</span></div>

<div class="viewcode-block" id="simulariumHelper.instancesSphere"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.instancesSphere">[docs]</a>    <span class="k">def</span> <span class="nf">instancesSphere</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">centers</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">meshsphere</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">scene</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centers</span><span class="p">)):</span>
            <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centers</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">meshsphere</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">meshsphere</span></div>

<div class="viewcode-block" id="simulariumHelper.instancesCylinder"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.instancesCylinder">[docs]</a>    <span class="k">def</span> <span class="nf">instancesCylinder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">scene</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">points</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span> <span class="n">materials</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mesh</span></div>

<div class="viewcode-block" id="simulariumHelper.FromVec"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.FromVec">[docs]</a>    <span class="k">def</span> <span class="nf">FromVec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">points</span>
        <span class="p">)</span>  <span class="c1"># np.array(float(points[0]),float(points[1]),float(points[2]))</span></div>

    <span class="c1">#</span>
<div class="viewcode-block" id="simulariumHelper.ToVec"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.ToVec">[docs]</a>    <span class="k">def</span> <span class="nf">ToVec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">v</span></div>

<div class="viewcode-block" id="simulariumHelper.spline"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.spline">[docs]</a>    <span class="k">def</span> <span class="nf">spline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">spline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Polylines</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>  <span class="c1"># ,faces=f)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">spline</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spline</span><span class="p">,</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.update_spline"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.update_spline">[docs]</a>    <span class="k">def</span> <span class="nf">update_spline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">new_points</span><span class="p">):</span>
        <span class="n">spline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">spline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_points</span><span class="p">))]</span>
        <span class="n">spline</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">new_points</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="simulariumHelper.Points"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.Points">[docs]</a>    <span class="k">def</span> <span class="nf">Points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="c1"># need to add the AtomArray modifier....</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;parent&quot;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">Simularium.Points</span> <span class="kn">import</span> <span class="n">Points</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">Points</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_object_to_scene</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">(),</span> <span class="n">obj</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="simulariumHelper.updatePoly"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.updatePoly">[docs]</a>    <span class="k">def</span> <span class="nf">updatePoly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">polygon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">polygon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">vertices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">polygon</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">faces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">polygon</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.updateMesh"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.updateMesh">[docs]</a>    <span class="k">def</span> <span class="nf">updateMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updatePoly</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">vertices</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.instancePolygon"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.instancePolygon">[docs]</a>    <span class="k">def</span> <span class="nf">instancePolygon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.changeColor"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.changeColor">[docs]</a>    <span class="k">def</span> <span class="nf">changeColor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">perVertex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proxyObject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pb</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMesh</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">materials</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">inheritMaterial</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.box"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.box">[docs]</a>    <span class="k">def</span> <span class="nf">box</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">cornerPoints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kw</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># import np</span>
        <span class="n">box</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">cornerPoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cornerPoints</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cornerPoints</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cornerPoints</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cornerPoints</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="n">box</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">cornerPoints</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cornerPoints</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">box</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">xside</span><span class="o">=</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yside</span><span class="o">=</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zside</span><span class="o">=</span><span class="n">size</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="c1"># material is a liste of color per faces.</span>
        <span class="c1"># aMat=addMaterial(&quot;wire&quot;)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;parent&quot;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">kw</span><span class="p">[</span><span class="s2">&quot;parent&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_object_to_scene</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">(),</span> <span class="n">box</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">box</span><span class="p">,</span> <span class="n">box</span></div>

<div class="viewcode-block" id="simulariumHelper.updateBox"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.updateBox">[docs]</a>    <span class="k">def</span> <span class="nf">updateBox</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">box</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">cornerPoints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># import np</span>
        <span class="n">box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cornerPoints</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">size</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cornerPoints</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">cornerPoints</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cornerPoints</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">cornerPoints</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
            <span class="n">box</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">cornerPoints</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cornerPoints</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">box</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span> <span class="n">xside</span><span class="o">=</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yside</span><span class="o">=</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zside</span><span class="o">=</span><span class="n">size</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span></div>

<div class="viewcode-block" id="simulariumHelper.getCornerPointCube"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getCornerPointCube">[docs]</a>    <span class="k">def</span> <span class="nf">getCornerPointCube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cube</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">side</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">xside</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">yside</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">zside</span><span class="p">)</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">center</span>
        <span class="n">cornerPoints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># lowCorner</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">uc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="n">center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">cornerPoints</span> <span class="o">=</span> <span class="p">[[</span><span class="n">lc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lc</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="n">uc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">uc</span><span class="p">[</span><span class="mi">2</span><span class="p">]]]</span>
        <span class="k">return</span> <span class="n">cornerPoints</span></div>

<div class="viewcode-block" id="simulariumHelper.plane"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.plane">[docs]</a>    <span class="k">def</span> <span class="nf">plane</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">cornerPoints</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kw</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># plane or grid</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.getFace"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getFace">[docs]</a>    <span class="k">def</span> <span class="nf">getFace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">face</span></div>

<div class="viewcode-block" id="simulariumHelper.getMeshVertices"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMeshVertices">[docs]</a>    <span class="k">def</span> <span class="nf">getMeshVertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIsMesh</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getVertices</span><span class="p">()</span></div>

<div class="viewcode-block" id="simulariumHelper.getMeshNormales"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMeshNormales">[docs]</a>    <span class="k">def</span> <span class="nf">getMeshNormales</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIsMesh</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getVNormals</span><span class="p">()</span></div>

<div class="viewcode-block" id="simulariumHelper.getMeshEdges"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMeshEdges">[docs]</a>    <span class="k">def</span> <span class="nf">getMeshEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="simulariumHelper.getMeshFaces"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getMeshFaces">[docs]</a>    <span class="k">def</span> <span class="nf">getMeshFaces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIsMesh</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mesh</span><span class="o">.</span><span class="n">getFaces</span><span class="p">()</span></div>

<div class="viewcode-block" id="simulariumHelper.isIndexedPolyon"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.isIndexedPolyon">[docs]</a>    <span class="k">def</span> <span class="nf">isIndexedPolyon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;getFaces&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="n">c</span><span class="p">,</span> <span class="n">ipoly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isIndexedPolyon</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ipoly</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="simulariumHelper.DecomposeMesh"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.DecomposeMesh">[docs]</a>    <span class="k">def</span> <span class="nf">DecomposeMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">,</span> <span class="n">edit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">poly</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">vertex_normals</span></div>

<div class="viewcode-block" id="simulariumHelper.changeColorO"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.changeColorO">[docs]</a>    <span class="k">def</span> <span class="nf">changeColorO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
        <span class="nb">object</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">materials</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.setRigidBody"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.setRigidBody">[docs]</a>    <span class="k">def</span> <span class="nf">setRigidBody</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.pathDeform"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.pathDeform">[docs]</a>    <span class="k">def</span> <span class="nf">pathDeform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.updatePathDeform"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.updatePathDeform">[docs]</a>    <span class="k">def</span> <span class="nf">updatePathDeform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

    <span class="c1"># ==============================================================================</span>
    <span class="c1"># IO / read/write 3D object, cene file etc</span>
    <span class="c1"># ==============================================================================</span>
<div class="viewcode-block" id="simulariumHelper.getColladaMaterial"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getColladaMaterial">[docs]</a>    <span class="k">def</span> <span class="nf">getColladaMaterial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="c1"># get the bound geometries</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">boundg</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">bg</span> <span class="ow">in</span> <span class="n">boundg</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bg</span><span class="o">.</span><span class="n">original</span> <span class="o">==</span> <span class="n">geom</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">materialnodebysymbol</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
                    <span class="n">k0</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">bg</span><span class="o">.</span><span class="n">materialnodebysymbol</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">mat</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">materialnodebysymbol</span><span class="p">[</span><span class="n">k0</span><span class="p">]</span><span class="o">.</span><span class="n">target</span>
        <span class="k">return</span> <span class="n">mat</span></div>

<div class="viewcode-block" id="simulariumHelper.TextureFaceCoordintesToVertexCoordinates"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.TextureFaceCoordintesToVertexCoordinates">[docs]</a>    <span class="k">def</span> <span class="nf">TextureFaceCoordintesToVertexCoordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ti</span><span class="p">):</span>
        <span class="n">textureuv_vertex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">indice_verex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">):</span>
                    <span class="n">indice</span> <span class="o">=</span> <span class="n">ti</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">indice</span> <span class="o">=</span> <span class="n">ti</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                <span class="n">textureuv_vertex</span><span class="p">[</span><span class="n">indice_verex</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>  <span class="c1"># (t[ti[i][j]]+1.0)/2.0</span>
        <span class="k">return</span> <span class="n">textureuv_vertex</span></div>

<div class="viewcode-block" id="simulariumHelper.getNormals"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.getNormals">[docs]</a>    <span class="k">def</span> <span class="nf">getNormals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ni</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ni</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">ni</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">n</span><span class="p">[</span><span class="n">ni</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="n">normals_vertex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">indice_vertex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">normals_vertex</span><span class="p">[</span><span class="n">indice_vertex</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span>
                        <span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="p">]</span>  <span class="c1"># (t[ti[i][j]]+1.0)/2.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">normals_vertex</span><span class="p">[</span><span class="n">indice_vertex</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">ni</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">normals_vertex</span></div>

<div class="viewcode-block" id="simulariumHelper.nodeToGeom"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.nodeToGeom">[docs]</a>    <span class="k">def</span> <span class="nf">nodeToGeom</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">node</span><span class="p">,</span>
        <span class="n">i</span><span class="p">,</span>
        <span class="n">col</span><span class="p">,</span>
        <span class="n">nodexml</span><span class="p">,</span>
        <span class="n">parentxml</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">dicgeoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">uniq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">nodexml</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">nodexml</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
        <span class="n">pname</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">parentxml</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pname</span> <span class="o">=</span> <span class="n">parentxml</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pname</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">pname</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">pname</span> <span class="o">=</span> <span class="n">parentxml</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
        <span class="n">onode</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">dicgeoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dicgeoms</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="n">collada</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">ExtraNode</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="n">collada</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">GeometryNode</span><span class="p">:</span>
            <span class="c1"># create a mesh under parent</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">geometry</span>
            <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dicgeoms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">dicgeoms</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">dicgeoms</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span>
                <span class="n">onode</span><span class="p">,</span> <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oneColladaGeom</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="n">dicgeoms</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="s2">&quot;node&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">onode</span>
                <span class="n">dicgeoms</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="s2">&quot;mesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mesh</span>
                <span class="n">dicgeoms</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="s2">&quot;instances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">dicgeoms</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="s2">&quot;parentmesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">gname</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">id</span>

                <span class="k">if</span> <span class="n">parentxml</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">dicgeoms</span><span class="p">[</span><span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="s2">&quot;parentmesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">parentxml</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># collada.scene.Node</span>
            <span class="c1"># create an empty</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">collada</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">GeometryNode</span>
            <span class="p">):</span>
                <span class="c1"># no empty just get parent name ?</span>
                <span class="n">gname</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">id</span>
                <span class="k">if</span> <span class="n">parentxml</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gname</span> <span class="ow">in</span> <span class="n">dicgeoms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">dicgeoms</span><span class="p">[</span><span class="n">gname</span><span class="p">][</span><span class="s2">&quot;parentmesh&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">dicgeoms</span><span class="p">[</span><span class="n">gname</span><span class="p">][</span><span class="s2">&quot;parentmesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">pname</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">uniq</span><span class="p">:</span>
                    <span class="n">onode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">rot</span><span class="p">,</span> <span class="n">trans</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Decompose4x4</span><span class="p">(</span>
                        <span class="n">node</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">onode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">reParent</span><span class="p">(</span><span class="n">onode</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
                    <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">translation</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
                    <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">rot</span><span class="p">)</span>  <span class="c1"># .reshape(4,4).transpose())</span>
                    <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
                    <span class="n">dicgeoms</span><span class="p">[</span><span class="n">gname</span><span class="p">][</span><span class="s2">&quot;parentmesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">onode</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">collada</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">NodeNode</span>
            <span class="p">):</span>
                <span class="c1"># this is an instance do nothing. we are going to use instanceFortrans matrix</span>
                <span class="n">gname</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">id</span>
                <span class="k">if</span> <span class="n">parentxml</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">gname</span> <span class="ow">in</span> <span class="n">dicgeoms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">dicgeoms</span><span class="p">[</span><span class="n">gname</span><span class="p">][</span><span class="s2">&quot;parentmesh&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">dicgeoms</span><span class="p">[</span><span class="n">gname</span><span class="p">][</span><span class="s2">&quot;parentmesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">pname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">onode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">rot</span><span class="p">,</span> <span class="n">trans</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Decompose4x4</span><span class="p">(</span>
                    <span class="n">node</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">onode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reParent</span><span class="p">(</span><span class="n">onode</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
                <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">translation</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
                <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">rot</span><span class="p">)</span>  <span class="c1"># .reshape(4,4).transpose())</span>
                <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">):</span>
                    <span class="n">dicgeoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodeToGeom</span><span class="p">(</span>
                        <span class="n">ch</span><span class="p">,</span>
                        <span class="n">j</span><span class="p">,</span>
                        <span class="n">col</span><span class="p">,</span>
                        <span class="n">ch</span><span class="o">.</span><span class="n">xmlnode</span><span class="p">,</span>
                        <span class="n">parentxml</span><span class="o">=</span><span class="n">nodexml</span><span class="p">,</span>
                        <span class="n">parent</span><span class="o">=</span><span class="n">onode</span><span class="p">,</span>
                        <span class="n">dicgeoms</span><span class="o">=</span><span class="n">dicgeoms</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="n">dicgeoms</span></div>

<div class="viewcode-block" id="simulariumHelper.transformNode"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.transformNode">[docs]</a>    <span class="k">def</span> <span class="nf">transformNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">parentxmlnode</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">parentxmlnode</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">parentxmlnode</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="n">collada</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">GeometryNode</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="n">collada</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">ExtraNode</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># create an empty</span>
            <span class="n">onode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">rot</span><span class="p">,</span> <span class="n">trans</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Decompose4x4</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
            <span class="c1">#                trans = [node.transforms[0].x,node.transforms[0].y,node.transforms[0].z]</span>
            <span class="c1">#                rot = []</span>
            <span class="c1">#                for i in range(1,4):</span>
            <span class="c1">#                    rot.extend([node.transforms[i].x,node.transforms[i].y,node.transforms[i].z,0.0])</span>
            <span class="c1">#                rot.extend([0.,0.,0.,1.0])</span>
            <span class="c1">#                scale = [node.transforms[4].x,node.transforms[4].y,node.transforms[4].z]</span>
            <span class="c1">#                onode.Set(translation = trans)#, rotation=rot*0,scale=scale)</span>
            <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">translation</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
            <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">rot</span><span class="p">)</span>  <span class="c1"># .reshape(4,4).transpose())</span>
            <span class="n">onode</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
            <span class="c1">#                onode.ConcatRotation(rot)</span>
            <span class="c1">#                onode.ConcatTranslation(trans)</span>
            <span class="c1">#                onode.Set(matrix)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transformNode</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">ch</span><span class="o">.</span><span class="n">xmlnode</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">onode</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.decomposeColladaGeom"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.decomposeColladaGeom">[docs]</a>    <span class="k">def</span> <span class="nf">decomposeColladaGeom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex</span><span class="p">)</span>  <span class="c1"># multiple primitive ?</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span><span class="p">)</span>
        <span class="n">sh</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span><span class="p">[:</span><span class="n">nf</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nf</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>
        <span class="n">ni</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">normal_index</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">ni</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNormals</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ni</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">vn</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>

<div class="viewcode-block" id="simulariumHelper.oneColladaGeom"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.oneColladaGeom">[docs]</a>    <span class="k">def</span> <span class="nf">oneColladaGeom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">name</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex</span>  <span class="c1"># multiple primitive ?</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span><span class="p">)</span>
        <span class="n">sh</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertex_index</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">nf</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>
        <span class="n">ni</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">normal_index</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">ni</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNormals</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ni</span><span class="p">)</span>
        <span class="n">onode</span><span class="p">,</span> <span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createsNmesh</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vn</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">mesh</span><span class="o">.</span><span class="n">inheritMaterial</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getColladaMaterial</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">diffuse</span><span class="p">)</span> <span class="o">==</span> <span class="n">collada</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">Map</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

                <span class="n">impath</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">diffuse</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">path</span>
                <span class="c1"># clean the path</span>
                <span class="n">impath</span> <span class="o">=</span> <span class="n">impath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;file:////&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">diffuse</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeObjColorMat</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
            <span class="n">matd</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="mi">1028</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">ambient</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">ambient</span><span class="p">)</span> <span class="o">!=</span> <span class="n">collada</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">Map</span>
            <span class="p">):</span>
                <span class="n">matd</span><span class="o">.</span><span class="n">prop</span><span class="p">[</span><span class="n">matd</span><span class="o">.</span><span class="n">AMBI</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">effect</span><span class="o">.</span><span class="n">ambient</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">onode</span><span class="p">,</span> <span class="n">mesh</span></div>

<div class="viewcode-block" id="simulariumHelper.write"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listObj</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="simulariumHelper.writeToFile"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.writeToFile">[docs]</a>    <span class="k">def</span> <span class="nf">writeToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polygon</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">bb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write to simularium file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">total_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">max_number_agents</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">)</span>
        <span class="n">x_size</span> <span class="o">=</span> <span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_size</span> <span class="o">=</span> <span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z_size</span> <span class="o">=</span> <span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">box_adjustment</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">box_size</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">,</span>
            <span class="n">y_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">,</span>
            <span class="n">z_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">n_agents</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)]</span>
        <span class="n">type_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">rotations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">viz_types</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">DEFAULT</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">unique_ids</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)]</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)]</span>
        <span class="n">n_subpoints</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">subpoints</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fiber_length</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_number_agents</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_mapping</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">data_at_time</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">time_mapping</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                <span class="n">n_agents</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">type_names</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span>
                <span class="n">unique_ids</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">id</span>
                <span class="n">radii</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">radius</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span>
                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">viz_type</span> <span class="o">==</span> <span class="n">VIZ_TYPE</span><span class="o">.</span><span class="n">FIBER</span><span class="p">:</span>
                    <span class="n">curve</span> <span class="o">=</span> <span class="n">data_at_time</span><span class="p">[</span><span class="s2">&quot;sub_points&quot;</span><span class="p">]</span>
                    <span class="n">viz_types</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">viz_type</span>
                    <span class="n">positions</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">rotations</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="n">scaled_control_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span>
                    <span class="n">subpoints</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaled_control_points</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                    <span class="n">n_subpoints</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">position</span> <span class="o">=</span> <span class="n">data_at_time</span><span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">]</span>
                    <span class="n">positions</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">-</span> <span class="n">box_adjustment</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">-</span> <span class="n">box_adjustment</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">-</span> <span class="n">box_adjustment</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="p">]</span>
                    <span class="n">rotation</span> <span class="o">=</span> <span class="n">data_at_time</span><span class="p">[</span><span class="s2">&quot;rotation&quot;</span><span class="p">]</span>
                    <span class="n">rotations</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">rotation</span>
                    <span class="n">viz_types</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">viz_type</span>
                    <span class="n">n_subpoints</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">camera_z_position</span> <span class="o">=</span> <span class="n">box_size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">box_size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="mf">100.0</span>
        <span class="n">converted_data</span> <span class="o">=</span> <span class="n">TrajectoryData</span><span class="p">(</span>
            <span class="n">meta_data</span><span class="o">=</span><span class="n">MetaData</span><span class="p">(</span>
                <span class="n">box_size</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">box_size</span><span class="p">),</span>
                <span class="n">camera_defaults</span><span class="o">=</span><span class="n">CameraData</span><span class="p">(</span>
                    <span class="n">position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">camera_z_position</span><span class="p">]),</span>
                    <span class="n">look_at_position</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
                    <span class="n">fov_degrees</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">agent_data</span><span class="o">=</span><span class="n">AgentData</span><span class="p">(</span>
                <span class="n">display_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_data</span><span class="p">,</span>
                <span class="n">times</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">total_steps</span><span class="p">))),</span>
                <span class="n">n_agents</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_agents</span><span class="p">),</span>
                <span class="n">viz_types</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">viz_types</span><span class="p">),</span>
                <span class="n">unique_ids</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">unique_ids</span><span class="p">),</span>
                <span class="n">types</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">type_names</span><span class="p">),</span>
                <span class="n">positions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">),</span>
                <span class="n">rotations</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rotations</span><span class="p">),</span>
                <span class="n">radii</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">radii</span><span class="p">),</span>
                <span class="n">subpoints</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">subpoints</span><span class="p">),</span>
                <span class="n">n_subpoints</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_subpoints</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">time_units</span><span class="o">=</span><span class="n">UnitData</span><span class="p">(</span><span class="s2">&quot;ns&quot;</span><span class="p">),</span>  <span class="c1"># nanoseconds</span>
            <span class="n">spatial_units</span><span class="o">=</span><span class="n">UnitData</span><span class="p">(</span><span class="s2">&quot;nm&quot;</span><span class="p">),</span>  <span class="c1"># nanometers</span>
        <span class="p">)</span>
        <span class="n">TrajectoryConverter</span><span class="p">(</span><span class="n">converted_data</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="simulariumHelper.raycast"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.raycast">[docs]</a>    <span class="k">def</span> <span class="nf">raycast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">intersect</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s2">&quot;count&quot;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">intersect</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="s2">&quot;fnormal&quot;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">intersect</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;hitpos&quot;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">intersect</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">intersect</span></div>

<div class="viewcode-block" id="simulariumHelper.raycast_test"><a class="viewcode-back" href="../../../../../cellpack.autopack.upy.simularium.html#cellpack.autopack.upy.simularium.simularium_helper.simulariumHelper.raycast_test">[docs]</a>    <span class="k">def</span> <span class="nf">raycast_test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">return</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Megan Riel-Mehan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>