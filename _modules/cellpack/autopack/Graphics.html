

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>cellpack.autopack.Graphics &mdash; cellPack 1.0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> cellPack
          

          
          </a>

          
            
            
              <div class="version">
                1.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#stable-release">Stable release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation.html#from-sources">From sources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">Package modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cellpack.html">cellpack package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cellpack.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cellpack.autopack.html">cellpack.autopack package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cellpack.bin.html">cellpack.bin package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cellpack.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cellpack.html#module-cellpack.example">cellpack.example module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cellpack.html#cellpack.example.Example"><code class="docutils literal notranslate"><span class="pre">Example</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../cellpack.html#module-cellpack">Module contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cellpack.html#cellpack.get_module_version"><code class="docutils literal notranslate"><span class="pre">get_module_version()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../recipe-schema.html">Cellpack Recipe Schema 1.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../recipe-schema.html#recipe-definition-properties">Recipe definition properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#name">name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#version">version</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../recipe-schema.html#example">example:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../recipe-schema.html#options-properties">Options properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#saveresult">saveResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#result-file">result_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#enviroonly">EnviroOnly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#canceldialog">cancelDialog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#pickweightedingr">pickWeightedIngr</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#pickrandpt">pickRandPt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#ingrlookforneighbours">ingrLookForNeighbours</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#overwriteplacemethod">overwritePlaceMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#boundingbox">boundingBox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#smallestproteinsize">smallestProteinSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#largestproteinsize">largestProteinSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#computegridparams">computeGridParams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#windowssize">windowsSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#runtimedisplay">runTimeDisplay</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#place-method">place_method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#use-gradient">use_gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#gradients">gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#innergridmethod">innerGridMethod</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#freeptsupdatethreshold">freePtsUpdateThreshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#use-periodicity">use_periodicity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#timer">_timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#hackfreepts">_hackFreepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../recipe-schema.html#example-options">example <code class="docutils literal notranslate"><span class="pre">Options</span></code>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../recipe-schema.html#ingredient-properties">Ingredient Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#id81">name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#molarity">molarity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#count">count</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#encapsulating-radius">encapsulating_radius</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#radii">radii</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#positions">positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#positions2">positions2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#spherefile">sphereFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#priority">priority</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#pdb">pdb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#color">color</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#meshfile">meshFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#meshname">meshName</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#coordsystem">coordsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#principal-vector">principal_vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#type">type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#offset">offset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#max-jitter">max_jitter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#jitter-attempts">jitter_attempts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#perturb-axis-amplitude">perturb_axis_amplitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#use-rotation-axis">use_rotation_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#rotation-axis">rotation_axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#rotation-range">rotation_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#use-orient-bias">use_orient_bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#orientbiasrotrangemin">orientBiasRotRangeMin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#orientbiasrotrangemax">orientBiasRotRangeMax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#cutoff-boundary">cutoff_boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#cutoff-surface">cutoff_surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#id162">place_method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#rejection-threshold">rejection_threshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#packing-mode">packing_mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#gradient">gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#proba-binding">proba_binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#proba-not-binding">proba_not_binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#is-attractor">is_attractor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#weight">weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#partners-name">partners_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#excluded-partners-name">excluded_partners_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#partners-position">partners_position</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#partners-weight">partners_weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#properties">properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#score">score</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#organism">organism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../recipe-schema.html#example-ingredient">example ingredient</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../contributing.html#deploying">Deploying</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">cellPack</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../cellpack.html">cellpack</a> &raquo;</li>
        
          <li><a href="../autopack.html">cellpack.autopack</a> &raquo;</li>
        
      <li>cellpack.autopack.Graphics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for cellpack.autopack.Graphics</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># Created on Mon Jul 12 15:04:18 2010</span>

<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># autoPACK Authors: Graham T. Johnson, Mostafa Al-Alusi, Ludovic Autin, Michel Sanner</span>
<span class="c1">#   Based on COFFEE Script developed by Graham Johnson between 2005 and 2010</span>
<span class="c1">#   with assistance from Mostafa Al-Alusi in 2009 and periodic input</span>
<span class="c1">#   from Arthur Olson&#39;s Molecular Graphics Lab</span>
<span class="c1">#</span>
<span class="c1"># autopack_viewer.py Authors: Ludovic Autin with minor editing/enhancement from G Johnson</span>
<span class="c1">#</span>
<span class="c1"># Copyright: Graham Johnson Â©2010</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#    autoPack is free software: you can redistribute it and/or modify</span>
<span class="c1">#    it under the terms of the GNU General Public License as published by</span>
<span class="c1">#    the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1">#    (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1">#    autoPack is distributed in the hope that it will be useful,</span>
<span class="c1">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1">#    GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1">#    You should have received a copy of the GNU General Public License</span>
<span class="c1">#    along with autoPack (See &quot;CopyingGNUGPL&quot; in the installation.</span>
<span class="c1">#    If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#</span>
<span class="c1">###############################################################################</span>
<span class="c1"># @author: Ludovic Autin</span>

<span class="c1"># Viewer/helper of autoPACK result.</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># DEJAVU COLORS</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">import</span> <span class="nn">cellpack.autopack</span> <span class="k">as</span> <span class="nn">autopack</span>

<span class="c1"># ===============================================================================</span>
<span class="c1"># to do :</span>
<span class="c1">#      - use layer for hiding the parent of ingredient ! probably faster than creating a specific hider object</span>
<span class="c1">#      - save-restore + grid intersecting continuation</span>
<span class="c1">#          =&gt;imply decompose env in Grid class and HistoVol class</span>
<span class="c1">#      - hierarchy</span>
<span class="c1">#</span>
<span class="c1"># ===============================================================================</span>
<span class="kn">import</span> <span class="nn">cellpack.autopack.upy</span> <span class="k">as</span> <span class="nn">upy</span>
<span class="kn">from</span> <span class="nn">cellpack.autopack.upy</span> <span class="kn">import</span> <span class="n">colors</span> <span class="k">as</span> <span class="n">upyColors</span>

<span class="kn">from</span> <span class="nn">.ingredient</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GrowIngredient</span><span class="p">,</span>
    <span class="n">ActinIngredient</span><span class="p">,</span>
    <span class="n">MultiCylindersIngr</span><span class="p">,</span>
    <span class="n">SingleCubeIngr</span><span class="p">,</span>
    <span class="n">SingleSphereIngr</span><span class="p">,</span>
    <span class="n">MultiSphereIngr</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="AutopackViewer"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer">[docs]</a><span class="k">class</span> <span class="nc">AutopackViewer</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    the base class for viewing/displaying autopack result in a specified viewer</span>
<span class="sd">    ie DejaVu, Cinema4D, Maya or Blender (which are supported hostApp by ePMV)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">helper</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ViewerType</span><span class="o">=</span><span class="s2">&quot;dejavu&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor of the AFViewer. Define the needed function for constructing</span>
<span class="sd">        the geometry representing the different compartment and recipe that have</span>
<span class="sd">        been used for the filling.</span>

<span class="sd">        @type  ViewerType: string</span>
<span class="sd">        @param ViewerType: name of the viewer / host application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">=</span> <span class="n">ViewerType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="c1"># get helperClass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span> <span class="o">=</span> <span class="n">helper</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">helperClass</span> <span class="o">=</span> <span class="n">upy</span><span class="o">.</span><span class="n">getHelperClass</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                <span class="c1">#                from DejaVu import Viewer</span>
                <span class="c1">#                master = Viewer()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span> <span class="o">=</span> <span class="n">helperClass</span><span class="p">()</span>  <span class="c1"># master=master)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span> <span class="o">=</span> <span class="n">helperClass</span><span class="p">()</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getCurrentScene</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrkdir</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>

        <span class="c1"># here can be add other viewer...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Box</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sc</span> <span class="o">=</span> <span class="n">sc</span>
        <span class="c1"># need some option such as display Point cloud, overall resolution, etc...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doPoints</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pointWidth</span> <span class="o">=</span> <span class="mf">3.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quality</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doSpheres</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visibleMesh</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">psph</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">staticMesh</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movingMesh</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doOrder</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renderDistance</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fbb</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meshGeoms</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;doPoints&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;doPoints&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;doSpheres&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;doSpheres&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;quality&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;quality&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">},</span>
            <span class="s2">&quot;pointWidth&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;pointWidth&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;visibleMesh&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;visibleMesh&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;doOrder&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;doOrder&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;renderDistance&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;renderDistance&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;_timer&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;_timer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">}</span>

<div class="viewcode-block" id="AutopackViewer.callFunction"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.callFunction">[docs]</a>    <span class="k">def</span> <span class="nf">callFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timer</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeFunction</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kw</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="AutopackViewer.timeFunction"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.timeFunction">[docs]</a>    <span class="k">def</span> <span class="nf">timeFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Measure the time for performing the provided function.</span>

<span class="sd">        @type  function: function</span>
<span class="sd">        @param function: the function to execute</span>
<span class="sd">        @type  args: list</span>
<span class="sd">        @param args: the list of arguments for the function</span>


<span class="sd">        @rtype:   list/array</span>
<span class="sd">        @return:  the center of mass of the coordinates</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kw</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;time &quot;</span> <span class="o">+</span> <span class="n">function</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">res</span></div>

<div class="viewcode-block" id="AutopackViewer.SetHistoVol"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.SetHistoVol">[docs]</a>    <span class="k">def</span> <span class="nf">SetHistoVol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">histo</span><span class="p">,</span> <span class="n">pad</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Define the current histo volume.</span>

<span class="sd">        @type  histo: autopack.HistoVol</span>
<span class="sd">        @param histo: the current histo-volume</span>
<span class="sd">        @type  pad: float</span>
<span class="sd">        @param pad: the pading value to extend the histo volume bounding box</span>
<span class="sd">        @type  display: boolean</span>
<span class="sd">        @param display: if a geometry is created to represent the envume box</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">histo</span> <span class="o">=</span> <span class="n">histo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">afviewer</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="c1"># add padding</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">boundingBox</span>
        <span class="k">if</span> <span class="n">bb</span> <span class="o">==</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no compartment no bb&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="mf">0.0</span><span class="p">,</span>
            <span class="mf">0.0</span><span class="p">,</span>
        <span class="p">]</span>  <span class="c1"># Oct 16,2012 Graham- need to control padding on 3 sides.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pad</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">px</span> <span class="o">=</span> <span class="n">pad</span>
            <span class="n">py</span> <span class="o">=</span> <span class="n">pad</span>
            <span class="n">pz</span> <span class="o">=</span> <span class="n">pad</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="n">pad</span>
        <span class="c1">#        bb[0] = [x-pad+pad, y-pad, z-pad+pad]</span>
        <span class="n">bb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">px</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">py</span><span class="p">,</span> <span class="n">z</span> <span class="o">-</span> <span class="n">pz</span><span class="p">]</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1">#        bb[1] = [x+pad-pad, y+pad, z+pad-pad]</span>
        <span class="n">bb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">px</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">py</span><span class="p">,</span> <span class="n">z</span> <span class="o">+</span> <span class="n">pz</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bounding box x with padding&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">boundingBox</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">display</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayEnv</span><span class="p">()</span></div>

<div class="viewcode-block" id="AutopackViewer.addMasterIngr"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.addMasterIngr">[docs]</a>    <span class="k">def</span> <span class="nf">addMasterIngr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a empty master/parent geometry for a ingredient</span>

<span class="sd">        @type  ingr: autopack.Ingredient</span>
<span class="sd">        @param ingr: the ingredient</span>
<span class="sd">        @type  parent: hostObject</span>
<span class="sd">        @param parent: specify a parent to insert under</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">compNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">compartment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">compartment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">compNum</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">compartment</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">gi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="n">gi</span></div>

<div class="viewcode-block" id="AutopackViewer.prepareMaster"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.prepareMaster">[docs]</a>    <span class="k">def</span> <span class="nf">prepareMaster</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create all empty master/parent geometry for the cytoplasm and</span>
<span class="sd">        all ingredient. If not in DejaVu prepare the meshes use for instanced</span>
<span class="sd">        geometry such as spheres and cylinders</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># create master for cytoplasm compartment</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;master&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_cytoplasm&quot;</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span>
        <span class="c1"># create masters for ingredients</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addMasterIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>

        <span class="c1"># fpg = self.vi.Geom(&#39;notFreePoints&#39;)</span>
        <span class="c1"># self.vi.AddObject(fpg)</span>
        <span class="n">vParentHiders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;ParentHiders&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span>
        <span class="p">)</span>  <span class="c1"># g</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">psph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">psph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;base_shape&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">vParentHiders</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;base_sphere&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">psph</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bsph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pesph</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">becyl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;base_cylinder&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">psph</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bcyl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;cylinder&quot;</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quality</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">becyl</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">staticMesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># dynamic object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">staticMesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;static&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">movingMesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;moving&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrga</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_PreviousIngrOrga&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span>
        <span class="p">)</span>  <span class="c1"># g</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prevIngr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_PreviousIngrExterior&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrga</span>
        <span class="p">)</span>  <span class="c1"># g</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrg</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_PreviousIngr&quot;</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_surface&quot;</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrga</span><span class="p">,</span>
            <span class="p">)</span>  <span class="c1"># g</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrg</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_PreviousIngr&quot;</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_inner&quot;</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrga</span><span class="p">,</span>
            <span class="p">)</span>  <span class="c1"># g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prevOrga</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_PreviousOrga&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prevIngrOrga</span>
        <span class="p">)</span>  <span class="c1"># g</span></div>

<div class="viewcode-block" id="AutopackViewer.displayEnv"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayEnv">[docs]</a>    <span class="k">def</span> <span class="nf">displayEnv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        display histo volume bounding box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;BoundingBox&quot;</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">histoBox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">cornerPoints</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">boundingBox</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histoBox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">histoBox</span> <span class="o">=</span> <span class="n">b</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">reParent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histoBox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayFillBox"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayFillBox">[docs]</a>    <span class="k">def</span> <span class="nf">displayFillBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        display the box used for compute the grid and fill</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fbb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fbb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="s2">&quot;fillBox&quot;</span><span class="p">,</span> <span class="n">cornerPoints</span><span class="o">=</span><span class="n">bb</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># maybe /10.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fbb</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayCompartment"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayCompartment">[docs]</a>    <span class="k">def</span> <span class="nf">displayCompartment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orga</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and display geometry for an compartment.</span>

<span class="sd">        @type  orga: autopack.Compartment</span>
<span class="sd">        @param orga: the compartment</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># create master for compartment</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;O</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span>
        <span class="c1"># g = self.helper.getObject(name)</span>
        <span class="c1"># if g is None:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Surface&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Matrix&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">orga</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">orga</span><span class="o">.</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">gs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="o">-</span><span class="n">orga</span><span class="o">.</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">gc</span>
        <span class="c1"># else:</span>
        <span class="c1">#     gs = self.helper.getObject(&#39;%s_Surface&#39; % orga.name)</span>
        <span class="c1">#     gc = self.helper.getObject(&#39;%s_Matrix&#39; % orga.name)</span>
        <span class="c1">#     self.orgaToMasterGeom[orga] = g</span>
        <span class="c1">#     self.orgaToMasterGeom[orga.number] = gs</span>
        <span class="c1">#     self.orgaToMasterGeom[-orga.number] = gc</span>

        <span class="c1"># create masters for ingredients</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfaceRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addMasterIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">gs</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">innerRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addMasterIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">gc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">orga</span><span class="o">.</span><span class="n">is_orthogonal_bounding_box</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># create the mesh for the compartment</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Mesh&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span>
            <span class="n">tet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">IndexedPolygons</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">vertices</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span>
                    <span class="n">faces</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span>
                    <span class="n">normals</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">vnormals</span><span class="p">,</span>
                    <span class="n">inheritFrontPolyMode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">frontPolyMode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
                    <span class="n">dejavu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">inheritCulling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">culling</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="n">inheritShading</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">tet</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
            <span class="c1">#            if self.ViewerType == &#39;dejavu&#39;:</span>
            <span class="c1">#                cp = self.vi.viewer.clipP[0]</span>
            <span class="c1">#                self.vi.viewer.GUI.clipvar[0][0].set(1)</span>
            <span class="c1">#                tet.AddClipPlane( cp, 1, False)</span>
            <span class="n">orga</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">tet</span>
        <span class="k">if</span> <span class="n">orga</span><span class="o">.</span><span class="n">representation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Rep&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="s2">&quot;O</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;orga.representation &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">orga</span><span class="o">.</span><span class="n">representation</span><span class="p">)</span>
            <span class="n">op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">orga</span><span class="o">.</span><span class="n">representation</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">reParent</span><span class="p">(</span><span class="n">orga</span><span class="o">.</span><span class="n">representation</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>
                <span class="c1">#        orga.ref_obj = name</span>

<div class="viewcode-block" id="AutopackViewer.createOrganelMesh"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.createOrganelMesh">[docs]</a>    <span class="k">def</span> <span class="nf">createOrganelMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orga</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">orga</span><span class="o">.</span><span class="n">is_orthogonal_bounding_box</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Mesh&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;maya&quot;</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;mesh_&quot;</span> <span class="o">+</span> <span class="n">name</span>  <span class="c1"># TODO fix this in maya</span>
            <span class="n">tet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">IndexedPolygons</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">vertices</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span>
                    <span class="n">faces</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span>
                    <span class="n">normals</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">vnormals</span><span class="p">,</span>
                    <span class="n">inheritFrontPolyMode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">frontPolyMode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
                    <span class="n">dejavu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">inheritCulling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">culling</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="n">inheritShading</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;flat&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">tet</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">orga</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">updateMesh</span><span class="p">(</span><span class="n">tet</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">orga</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.toggleOrganelMesh"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.toggleOrganelMesh">[docs]</a>    <span class="k">def</span> <span class="nf">toggleOrganelMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organame</span><span class="p">,</span> <span class="n">display</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">organame</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Mesh&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">display</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.toggleOrganelMatr"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.toggleOrganelMatr">[docs]</a>    <span class="k">def</span> <span class="nf">toggleOrganelMatr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organame</span><span class="p">,</span> <span class="n">display</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">organame</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Matrix&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">display</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.toggleOrganelSurf"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.toggleOrganelSurf">[docs]</a>    <span class="k">def</span> <span class="nf">toggleOrganelSurf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organame</span><span class="p">,</span> <span class="n">display</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">organame</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_Surface&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">display</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayCompartments"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayCompartments">[docs]</a>    <span class="k">def</span> <span class="nf">displayCompartments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and display geometry for all compartments defined for the envume.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayCompartment</span><span class="p">(</span><span class="n">orga</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayPreFill"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayPreFill">[docs]</a>    <span class="k">def</span> <span class="nf">displayPreFill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use this function once a env and his compartments are defined.</span>
<span class="sd">        displayPreFill will prepare all master, and will create the geometry for</span>
<span class="sd">        the histovolume bounding box, and the different compartments defined.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># use this script once a env and compartments are defined</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepareMaster</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">displayCompartments</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">displayEnv</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepareIngredient</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepareDynamic</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># change the viewportshadr</span>
            <span class="kn">from</span> <span class="nn">.ray</span> <span class="kn">import</span> <span class="n">vlen</span><span class="p">,</span> <span class="n">vdiff</span>

            <span class="n">boundingBox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">boundingBox</span>
            <span class="n">xl</span><span class="p">,</span> <span class="n">yl</span><span class="p">,</span> <span class="n">zl</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">xr</span><span class="p">,</span> <span class="n">yr</span><span class="p">,</span> <span class="n">zr</span> <span class="o">=</span> <span class="n">boundingBox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">diag</span> <span class="o">=</span> <span class="n">vlen</span><span class="p">(</span><span class="n">vdiff</span><span class="p">((</span><span class="n">xr</span><span class="p">,</span> <span class="n">yr</span><span class="p">,</span> <span class="n">zr</span><span class="p">),</span> <span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">yl</span><span class="p">,</span> <span class="n">zl</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">diag</span> <span class="o">&lt;</span> <span class="mf">10000.0</span><span class="p">:</span>
                <span class="n">diag</span> <span class="o">=</span> <span class="mf">10000.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setViewport</span><span class="p">(</span>
                <span class="n">clipstart</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">clipend</span><span class="o">=</span><span class="n">diag</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>  <span class="c1"># shader=&quot;glsl&quot;,</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#########VIEWPORT SET#######&quot;</span><span class="p">)</span></div>
        <span class="c1">#        elif self.ViewerType == &#39;dejavu&#39;:</span>
        <span class="c1">#            self.vi.viewer.Reset_cb()</span>
        <span class="c1">#            self.vi.viewer.Normalize_cb()</span>
        <span class="c1">#            self.vi.viewer.Center_cb()</span>
        <span class="c1">#            cam = self.vi.viewer.currentCamera</span>
        <span class="c1">#            #cam.master.master.geometry(&#39;%dx%d+%d+%d&#39;%(400,400, 92, 73))</span>
        <span class="c1">#            self.vi.viewer.update()</span>
        <span class="c1">#            cam.fog.Set(enabled=1)</span>
        <span class="c1">#            sph = self.vi.Spheres(&#39;debugSph&#39;, inheritMaterial=False)</span>
        <span class="c1">#            self.vi.AddObject(sph)</span>
        <span class="c1">#        else :</span>
        <span class="c1">#            #we can probably setup here the overall quality in the viewport</span>
        <span class="c1">#            pass</span>

<div class="viewcode-block" id="AutopackViewer.colorPT"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.colorPT">[docs]</a>    <span class="k">def</span> <span class="nf">colorPT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">pass</span></div>

    <span class="c1">#        pt = self.vi.getObject(name)</span>
    <span class="c1">#        from DejaVu.colorTool import Map, RGBRamp</span>
    <span class="c1">#        from DejaVu.colorMap import ColorMap</span>
    <span class="c1">#        #from DejaVu.colorMapLegend import ColorMapLegend</span>
    <span class="c1">#        ramp = RGBRamp()</span>
    <span class="c1">#        v=values</span>
    <span class="c1">#        colors = Map(v, ramp)</span>
    <span class="c1">#        self.vi.changeColor(pt,colors)</span>

<div class="viewcode-block" id="AutopackViewer.prepareDynamic"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.prepareDynamic">[docs]</a>    <span class="k">def</span> <span class="nf">prepareDynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># create two empty for static and moving object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movingMesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">&quot;movingMesh&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">movingMesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">movingMesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="s2">&quot;movingMesh&quot;</span><span class="p">)</span>
        <span class="c1">#            self.vi.addObjectToScene(None,self.movingMesh)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setRigidBody</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">movingMesh</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">dynamicOptions</span><span class="p">[</span><span class="s2">&quot;moving&quot;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">staticMesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">&quot;staticMesh&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">staticMesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">staticMesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="s2">&quot;staticMesh&quot;</span><span class="p">)</span>
        <span class="c1">#            self.vi.addObjectToScene(None,self.staticMesh)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setRigidBody</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">staticMesh</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">dynamicOptions</span><span class="p">[</span><span class="s2">&quot;static&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="AutopackViewer.displayFill"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayFill">[docs]</a>    <span class="k">def</span> <span class="nf">displayFill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use this function once a Box have been filled. displayFill will display</span>
<span class="sd">        all placed ingredients in the Box, and affiliated them according if they are</span>
<span class="sd">        on surface, in cytoplasm or in the compartment. displayFill also display</span>
<span class="sd">        optionally the different point grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayPreFill</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">resetProgressBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">progressBar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;displayFill&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doPoints</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">progressBar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;displayPoints&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callFunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displayCompartmentsPoints</span><span class="p">)</span>  <span class="c1"># ()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callFunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displayFreePoints</span><span class="p">)</span>  <span class="c1"># ()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">progressBar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;displayCytoplasmIngredients&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callFunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displayCytoplasmIngredients</span><span class="p">)</span>  <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">progressBar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;displayCompartmentsIngredients&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callFunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displayCompartmentsIngredients</span><span class="p">)</span>  <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">&quot;autopackHider&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">&quot;autopackHider&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="p">,</span> <span class="s2">&quot;distToClosestSurf&quot;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">distToClosestSurf</span><span class="p">):</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartment_ids</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">lab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span>
                    <span class="s2">&quot;distanceLab&quot;</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">verts</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">0</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="p">,</span> <span class="s2">&quot;jitter_vectors&quot;</span><span class="p">):</span>
                <span class="c1">#                from DejaVu.Polylines import Polylines</span>
                <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">jitterVectors</span><span class="p">:</span>
                    <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">))</span>

                <span class="n">jv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Polylines</span><span class="p">(</span>
                    <span class="s2">&quot;jitter_vectors&quot;</span><span class="p">,</span>
                    <span class="n">vertices</span><span class="o">=</span><span class="n">verts</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">inheritLineWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">lineWidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">jv</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">resetProgressBar</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># change the viewportshadr</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setViewport</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayPoints"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayPoints">[docs]</a>    <span class="k">def</span> <span class="nf">displayPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use this function to display a pointCloud. By default, theses points</span>
<span class="sd">        are not visible in the viewport.</span>

<span class="sd">        @type  name: string</span>
<span class="sd">        @param name: the name of the point cloud object</span>
<span class="sd">        @type  points: list</span>
<span class="sd">        @param points: list of point indice or list point array</span>
<span class="sd">        @type  parent: hostObject</span>
<span class="sd">        @param parent: the parent of the point cloud</span>
<span class="sd">        @type  colors: list</span>
<span class="sd">        @param colors: point color array [r,g,b]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot; have no points&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="c1">#            verts,labels=[(self.histo.grid.masterGridPositions[ptInd],&quot;%d&quot;%ptInd) for ptInd in points]</span>
            <span class="k">for</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
                <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">ptInd</span><span class="p">])</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ptInd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#            verts,labels=[(pt,&quot;%d&quot;%i) for i,pt in enumerate(points)]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
                <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">verts</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Points</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">vertices</span><span class="o">=</span><span class="n">verts</span><span class="p">,</span>
                <span class="n">materials</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">pointWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pointWidth</span><span class="p">,</span>
                <span class="n">inheritPointWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">labDistg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Labels</span><span class="p">(</span>
                <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;Lab&quot;</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">verts</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">0</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">labDistg</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayCompartmentPoints"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayCompartmentPoints">[docs]</a>    <span class="k">def</span> <span class="nf">displayCompartmentPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orga</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use this function to display grid pointCloud for an compartment</span>

<span class="sd">        @type  orga: autopack.Compartment</span>
<span class="sd">        @param orga: the compartment</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vGridPointHider</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">orga</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;GridPointHider&quot;</span><span class="p">)</span>  <span class="c1"># g</span>
        <span class="k">if</span> <span class="n">vGridPointHider</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># g</span>
            <span class="n">vGridPointHider</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                <span class="n">orga</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;GridPointHider&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">orga</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orga</span><span class="o">.</span><span class="n">surfacePoints</span><span class="p">):</span>
                <span class="n">pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfacePointsNormals</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">pt</span><span class="p">,</span>
                        <span class="p">(</span>
                            <span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                            <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                            <span class="n">pt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">norm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                        <span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Polylines</span><span class="p">(</span><span class="s2">&quot;normals&quot;</span><span class="p">,</span> <span class="n">vertices</span><span class="o">=</span><span class="n">verts</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">orga</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">orga</span><span class="o">.</span><span class="n">is_orthogonal_bounding_box</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">orga</span><span class="p">,</span> <span class="s2">&quot;ogsurfacePoints&quot;</span><span class="p">):</span>
                <span class="c1"># display off grid surface grid points</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayPoints</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_OGsurfacePts&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">orga</span><span class="o">.</span><span class="n">ogsurfacePoints</span><span class="p">,</span> <span class="n">vGridPointHider</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">orga</span><span class="p">,</span> <span class="s2">&quot;surfacePoints&quot;</span><span class="p">):</span>
                <span class="c1"># display surface grid points</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayPoints</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_surfacePts&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">orga</span><span class="o">.</span><span class="n">surfacePoints</span><span class="p">,</span>
                    <span class="n">vGridPointHider</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">orga</span><span class="p">,</span> <span class="s2">&quot;insidePoints&quot;</span><span class="p">):</span>
            <span class="c1"># display interior grid points</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;orga.name =&quot;</span><span class="p">,</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;orga.insidePoints =&quot;</span><span class="p">,</span> <span class="n">orga</span><span class="o">.</span><span class="n">insidePoints</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.orgaToMasterGeom[orga] =&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">orga</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayPoints</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_insidePts&quot;</span> <span class="o">%</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">orga</span><span class="o">.</span><span class="n">insidePoints</span><span class="p">,</span>
                <span class="n">vGridPointHider</span><span class="p">,</span>
                <span class="n">colors</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayCompartmentsPoints"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayCompartmentsPoints">[docs]</a>    <span class="k">def</span> <span class="nf">displayCompartmentsPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and display grid points for all compartments defined for the envume.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayCompartmentPoints</span><span class="p">(</span><span class="n">orga</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.hideIngrPrimitive"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.hideIngrPrimitive">[docs]</a>    <span class="k">def</span> <span class="nf">hideIngrPrimitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="n">pname</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_SPH&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">pname</span><span class="p">)</span>  <span class="c1"># or ingr.mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.showIngrPrimitive"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.showIngrPrimitive">[docs]</a>    <span class="k">def</span> <span class="nf">showIngrPrimitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;isph&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buildIngrPrimitive</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pname</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_SPH&quot;</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">pname</span><span class="p">)</span>  <span class="c1"># or ingr.mesh</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.buildIngrPrimitive"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.buildIngrPrimitive">[docs]</a>    <span class="k">def</span> <span class="nf">buildIngrPrimitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Spheres_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="n">sph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Spheres</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">centers</span><span class="o">=</span><span class="n">ingr</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                <span class="n">radii</span><span class="o">=</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">visible</span><span class="o">=</span><span class="n">visible</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">sph</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">oparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>  <span class="c1"># or ingr.mesh or o_name or gname ?</span>
            <span class="n">pname</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_SPH&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;found &quot;</span><span class="p">,</span> <span class="n">oparent</span><span class="p">,</span> <span class="n">pname</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">pname</span><span class="p">)</span>  <span class="c1"># or ingr.mesh</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">pname</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">oparent</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;isph&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">names</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">o_name</span> <span class="o">+</span> <span class="s2">&quot;_sph&quot;</span>
                <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">)):</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">pname</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
                    <span class="n">lparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">lparent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">lparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
                    <span class="n">isph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancesSphere</span><span class="p">(</span>
                        <span class="n">names</span><span class="p">,</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                        <span class="n">parent</span><span class="o">=</span><span class="n">lparent</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">isph</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">)):</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">pname</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
                    <span class="n">lparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">lparent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">lparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">updateInstancesSphere</span><span class="p">(</span>
                        <span class="n">names</span><span class="p">,</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
                        <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                        <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                        <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span></div>
                <span class="c1">#        else : #cylinder or growingredient#if ingrmodel_type==&#39;Spheres&#39;:</span>
                <span class="c1">#            pass</span>

<div class="viewcode-block" id="AutopackViewer.displayIngrSpheres"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayIngrSpheres">[docs]</a>    <span class="k">def</span> <span class="nf">displayIngrSpheres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Spheres_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                    <span class="n">sph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Spheres</span><span class="p">(</span>
                        <span class="n">name</span><span class="p">,</span>
                        <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">centers</span><span class="o">=</span><span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                        <span class="n">materials</span><span class="o">=</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                        <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                        <span class="n">visible</span><span class="o">=</span><span class="n">visible</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">sph</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">names</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span>
                        <span class="o">+</span> <span class="s2">&quot;S&quot;</span>
                        <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                            <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
                        <span class="p">)</span>
                    <span class="c1">#                        self.vi.AddObject(parent,parent=self.orgaToMasterGeom[ingr])</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;isph&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancesSphere</span><span class="p">(</span>
                            <span class="n">names</span><span class="p">,</span>
                            <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                            <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                        <span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">updateInstancesSphere</span><span class="p">(</span>
                            <span class="n">names</span><span class="p">,</span>
                            <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span><span class="p">,</span>
                            <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                            <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                            <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayIngrCylinders"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayIngrCylinders">[docs]</a>    <span class="k">def</span> <span class="nf">displayIngrCylinders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c1"># dont do it for a snake ingredient...</span>
        <span class="c1"># just use the realtime capbility</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">GrowIngredient</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">])</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">GrowIngredient</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">use_rbsphere</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">nbCurve</span><span class="p">):</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_Spheres_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">names</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span>
                        <span class="o">+</span> <span class="s2">&quot;S&quot;</span>
                        <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                            <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
                        <span class="p">)</span>
                    <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">rad</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">listePtLinear</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">pt1</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">listePtLinear</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                        <span class="n">pt2</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">listePtLinear</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="n">r</span><span class="p">,</span> <span class="n">pts</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">getInterpolatedSphere</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>
                        <span class="n">pos</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
                        <span class="n">rad</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;isph&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancesSphere</span><span class="p">(</span>
                            <span class="n">names</span><span class="p">,</span>
                            <span class="n">pos</span><span class="p">,</span>
                            <span class="n">rad</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                        <span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">updateInstancesSphere</span><span class="p">(</span>
                            <span class="n">names</span><span class="p">,</span>
                            <span class="n">ingr</span><span class="o">.</span><span class="n">isph</span><span class="p">,</span>
                            <span class="n">pos</span><span class="p">,</span>
                            <span class="n">rad</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                            <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">)</span>

                <span class="k">return</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Cylinders_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="n">cyl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Cylinders</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">vertices</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                <span class="n">faces</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                <span class="n">visible</span><span class="o">=</span><span class="n">visible</span><span class="p">,</span>
                <span class="n">inheritCulling</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">culling</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
                <span class="n">inheritFrontPolyMode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">frontPolyMode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">cyl</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span>
                <span class="o">+</span> <span class="s2">&quot;C&quot;</span>
                <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="c1"># name=self.orgaToMasterGeom[ingr].GetName()+&quot;Cylinders&quot;</span>
            <span class="c1"># parent=self.vi.newEmpty(name)</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;icyl&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">icyl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">icyl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancesCylinder</span><span class="p">(</span>
                    <span class="n">names</span><span class="p">,</span>
                    <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                    <span class="n">f</span><span class="p">,</span>
                    <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">becyl</span><span class="p">,</span>
                    <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">icyl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">updateInstancesCylinder</span><span class="p">(</span>
                    <span class="n">names</span><span class="p">,</span>
                    <span class="n">ingr</span><span class="o">.</span><span class="n">icyl</span><span class="p">,</span>
                    <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                    <span class="n">f</span><span class="p">,</span>
                    <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">becyl</span><span class="p">,</span>
                    <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                    <span class="n">delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayIngrGrows"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayIngrGrows">[docs]</a>    <span class="k">def</span> <span class="nf">displayIngrGrows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">GrowIngredient</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                    <span class="n">ingr</span><span class="p">,</span> <span class="n">ActinIngredient</span>
                <span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrGrow</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
        <span class="c1"># compartment ingr</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="c1"># compartment surface ingr</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfaceRecipe</span>
            <span class="k">if</span> <span class="n">rs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">rs</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">GrowIngredient</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                        <span class="n">ingr</span><span class="p">,</span> <span class="n">ActinIngredient</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrGrow</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
            <span class="c1"># compartment matrix ingr</span>
            <span class="n">ri</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">innerRecipe</span>
            <span class="k">if</span> <span class="n">ri</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">GrowIngredient</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
                        <span class="n">ingr</span><span class="p">,</span> <span class="n">ActinIngredient</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrGrow</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayIngrGrow"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayIngrGrow">[docs]</a>    <span class="k">def</span> <span class="nf">displayIngrGrow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;displayIngrGrow&quot;</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">nbCurve</span><span class="p">)</span>
        <span class="c1"># how to restore / store gro ingedient</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
        <span class="n">pobj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">unitParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pobj</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">unitParent</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">nbCurve</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;build curve &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;snake_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">snake</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">snake</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">snake</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">spline</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">ingr</span><span class="o">.</span><span class="n">listePtLinear</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">close</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">scene</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">update_spline</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">listePtLinear</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">snake</span><span class="p">,</span> <span class="n">visible</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pobj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_unit_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="c1"># pathDeform instance of one turn using snake</span>
                <span class="n">actine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">actine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">actine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">new_instance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pobj</span><span class="p">)</span>
                <span class="n">modifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;pd&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">modifier</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">modifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">pathDeform</span><span class="p">(</span><span class="n">actine</span><span class="p">,</span> <span class="n">snake</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">updatePathDeform</span><span class="p">(</span><span class="n">modifier</span><span class="p">,</span> <span class="nb">object</span><span class="o">=</span><span class="n">actine</span><span class="p">,</span> <span class="n">spline</span><span class="o">=</span><span class="n">snake</span><span class="p">)</span>
                    <span class="c1"># what about a reall long one -&gt; cloner or instance</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># is that not correctly scaled ?</span>
                    <span class="n">circle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">build_2dshape</span><span class="p">(</span>
                        <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_shape&quot;</span><span class="p">,</span>
                        <span class="n">opts</span><span class="o">=</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">encapsulating_radius</span><span class="p">],</span>
                    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">extruder</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">extrudeSpline</span><span class="p">(</span>
                        <span class="n">snake</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">circle</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span>
                    <span class="p">)</span>  <span class="c1"># shoud use the radius for a circle ?</span></div>
                    <span class="c1"># reparent ?</span>
                    <span class="c1"># should wereparent the extruder</span>
                    <span class="c1"># what about primitive display self.doSpheres</span>

<div class="viewcode-block" id="AutopackViewer.delIngredientGrow"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.delIngredientGrow">[docs]</a>    <span class="k">def</span> <span class="nf">delIngredientGrow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;delIngrGrow&quot;</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">nbCurve</span><span class="p">)</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
        <span class="c1">#        o = ingr.recipe().organelle()</span>
        <span class="n">pobj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">unitParent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pobj</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">unitParent</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">nbCurve</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;snake_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">snake</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">snake</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pobj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_unit_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="c1"># pathDeform instance of one turn using snake</span>
                <span class="n">actine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">actine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">actine</span><span class="p">)</span>
                <span class="n">modifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;pd&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">modifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">modifier</span><span class="p">)</span>
                    <span class="c1"># what about a reall long one -&gt; cloner or instance</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># delete the extruder what is the name of the extruder and how delete it.</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ext_&quot;</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;snake_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="n">extruder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">extruder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">extruder</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.prepareIngredient"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.prepareIngredient">[docs]</a>    <span class="k">def</span> <span class="nf">prepareIngredient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># cyto ingr</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayIngredients</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

            <span class="c1"># compartment ingr</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="c1"># compartment surface ingr</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfaceRecipe</span>
            <span class="c1"># compartment matrix ingr</span>
            <span class="n">ri</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">innerRecipe</span>
            <span class="k">if</span> <span class="n">rs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngredients</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ri</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngredients</span><span class="p">(</span><span class="n">ri</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayIngredients"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayIngredients">[docs]</a>    <span class="k">def</span> <span class="nf">displayIngredients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipes</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">recipes</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># mes_3d?</span>
                <span class="c1"># try get it</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># display mesh</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createIngrMesh</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span></div>

<div class="viewcode-block" id="AutopackViewer.createIngrMesh"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.createIngrMesh">[docs]</a>    <span class="k">def</span> <span class="nf">createIngrMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
        <span class="n">geom</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span>
        <span class="c1"># START New section added by Graham on July 16, 2012 replaces section below</span>
        <span class="c1"># This version allows the user to hide the parent geometry from the center of the scene very easily</span>
        <span class="c1"># This version MAY NOT be safe outside of Cinema 4D  Can we test it ???</span>
        <span class="n">vParentHiders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;ParentHiders&quot;</span><span class="p">)</span>  <span class="c1"># g</span>
        <span class="k">if</span> <span class="n">vParentHiders</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># g</span>
            <span class="n">vParentHiders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;ParentHiders&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span>
            <span class="p">)</span>  <span class="c1"># g</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">vParentHiders</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;MeshsParent&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># g</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;MeshsParent&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">vParentHiders</span>
            <span class="p">)</span>  <span class="c1"># g</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;mesh_3d&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>  <span class="c1"># or parent is None:  #mod by g</span>
            <span class="c1">#        if not hasattr(ingr,&quot;mesh_3d&quot;) or ingr.mesh_3d is None or parent is None:  #off by g</span>
            <span class="c1">#            parent=self.vi.newEmpty(ingr.name+&quot;MeshsParent&quot;, parent=self.orgaToMasterGeom[ingr]) # off by g</span>
            <span class="c1"># END New section added by Graham on July 16, 2012</span>

            <span class="c1"># START original section removed by Graham on July 16, 2012</span>
            <span class="c1">#        parent = self.vi.getObject(ingr.name+&quot;MeshsParent&quot;)</span>
            <span class="c1">#        if not hasattr(ingr,&quot;mesh_3d&quot;) or ingr.mesh_3d is None or parent is None:</span>
            <span class="c1">#            parent=self.vi.newEmpty(ingr.name+&quot;MeshsParent&quot;, parent=self.orgaToMasterGeom[ingr])</span>
            <span class="c1"># END original section removed by Graham on July 16, 2012</span>

            <span class="c1"># create the polygon</span>
            <span class="c1"># from DejaVu.IndexedPolygons import IndexedPolygons</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;Mesh&quot;</span>
            <span class="n">material</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">material</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">retrieveColorMat</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="s2">&quot;getFaces&quot;</span><span class="p">):</span>
                <span class="n">polygon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">createsNmesh</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                    <span class="n">geom</span><span class="o">.</span><span class="n">getVertices</span><span class="p">(),</span>
                    <span class="kc">None</span><span class="p">,</span>
                    <span class="n">geom</span><span class="o">.</span><span class="n">getFaces</span><span class="p">(),</span>
                    <span class="n">material</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">polygon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">new_instance</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">material</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span>
                <span class="p">)</span>  <span class="c1"># identity?</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibleMesh</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">polygon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1">#            self.vi.setTranslation(parent,pos=[1000.,1000.,1000.])</span>
            <span class="c1">#            if self.vi.host.find(&quot;blender&quot;) != -1 :</span>
            <span class="c1">#                self.orgaToMasterGeom[ingr]= polygon</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;mesh_3d&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="o">=</span> <span class="n">parent</span>  <span class="c1"># polygon[0] is this will work in other host</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;after build&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayIngrMesh"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayIngrMesh">[docs]</a>    <span class="k">def</span> <span class="nf">displayIngrMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrices</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="n">matrices</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">createIngrMesh</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span></div>

<div class="viewcode-block" id="AutopackViewer.printOneIngr"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.printOneIngr">[docs]</a>    <span class="k">def</span> <span class="nf">printOneIngr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;one ingredient:&quot;</span><span class="p">,</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">molarity</span><span class="p">,</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">pdb</span><span class="p">,</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">principal_vector</span><span class="p">,</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">max_jitter</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.printIngredients"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.printIngredients">[docs]</a>    <span class="k">def</span> <span class="nf">printIngredients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printOneIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span> <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfaceRecipe</span>
            <span class="k">if</span> <span class="n">rs</span><span class="p">:</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printOneIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span> <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">rs</span><span class="o">.</span><span class="n">ingredients</span><span class="p">]</span>
            <span class="n">ri</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">innerRecipe</span>
            <span class="k">if</span> <span class="n">ri</span><span class="p">:</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">printOneIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span> <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">ingredients</span><span class="p">]</span></div>

<div class="viewcode-block" id="AutopackViewer.collectResult"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.collectResult">[docs]</a>    <span class="k">def</span> <span class="nf">collectResult</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">):</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">deepest_level</span>
        <span class="n">px</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">transformPoints</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">])):</span>
                <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Cylinders&quot;</span><span class="p">:</span>
            <span class="n">px2</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">transformPoints</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">positions2</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">])):</span>
                <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px2</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
                <span class="n">radii</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">rot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">mat</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
            <span class="n">mat</span> <span class="o">=</span> <span class="n">rot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">mat</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="k">return</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.replaceIngrMesh"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.replaceIngrMesh">[docs]</a>    <span class="k">def</span> <span class="nf">replaceIngrMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="n">newMesh</span><span class="p">):</span>
        <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_3d</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>  <span class="c1"># should be an empty or locator</span>
        <span class="n">childs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">childs</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no Childs&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="n">childs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingredient</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;softimage&quot;</span><span class="p">:</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="n">polygon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">updateMasterInstance</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="p">[</span><span class="n">newMesh</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">newMesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">newMesh</span><span class="p">)</span>
            <span class="c1"># ingredient.mesh_3d = newMesh</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingredient</span><span class="p">]</span> <span class="o">=</span> <span class="n">newMesh</span>  <span class="c1"># permit to toggle the display</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">newMesh</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="AutopackViewer.displayIngrResults"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayIngrResults">[docs]</a>    <span class="k">def</span> <span class="nf">displayIngrResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="n">doSphere</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">doMesh</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display the result for the given ingr after filling</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ingredient</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no ingredient provided&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
        <span class="c1">#        comp = ingredient.compNum</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">matrices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># retrieve the result from the molecules array of the recipes</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collectResult</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="n">o</span><span class="o">.</span><span class="n">molecules</span>
            <span class="k">if</span> <span class="n">ingr</span> <span class="o">==</span> <span class="n">ingredient</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">radii</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">matrices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;collected &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrices</span><span class="p">),</span> <span class="n">doMesh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doSphere</span> <span class="ow">and</span> <span class="n">verts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrSpheres</span><span class="p">(</span>
                    <span class="n">ingredient</span><span class="p">,</span> <span class="p">{</span><span class="n">ingredient</span><span class="p">:</span> <span class="n">verts</span><span class="p">},</span> <span class="p">{</span><span class="n">ingredient</span><span class="p">:</span> <span class="n">radii</span><span class="p">},</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Cylinders&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrCylinders</span><span class="p">(</span>
                    <span class="n">ingredient</span><span class="p">,</span> <span class="p">{</span><span class="n">ingredient</span><span class="p">:</span> <span class="n">verts</span><span class="p">},</span> <span class="p">{</span><span class="n">ingredient</span><span class="p">:</span> <span class="n">radii</span><span class="p">},</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="n">doMesh</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrices</span><span class="p">):</span>
            <span class="n">dejavui</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_3d</span>
                <span class="k">if</span> <span class="n">polygon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createIngrMesh</span><span class="p">(</span><span class="n">ingredient</span><span class="p">)</span>
                    <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_3d</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Meshs_&quot;</span> <span class="o">+</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                        <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingredient</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="n">instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                <span class="n">dejavui</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingredient</span><span class="p">,</span> <span class="s2">&quot;ipoly&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">ipoly</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">dejavui</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="n">ingredient</span><span class="o">.</span><span class="n">color</span><span class="p">]</span> <span class="k">if</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">principal_vector</span><span class="p">[:])</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;build ipoly &quot;</span><span class="p">,</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">o_name</span><span class="p">)</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">ipoly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancePolygon</span><span class="p">(</span>
                    <span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span> <span class="o">+</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">o_name</span><span class="p">,</span>
                    <span class="n">matrices</span><span class="o">=</span><span class="n">matrices</span><span class="p">,</span>
                    <span class="n">mesh</span><span class="o">=</span><span class="n">polygon</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                    <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayInstancesIngredient"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayInstancesIngredient">[docs]</a>    <span class="k">def</span> <span class="nf">displayInstancesIngredient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="n">matrices</span><span class="p">):</span>
        <span class="c1">#        geom = ingredient.mesh</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_3d</span>
            <span class="k">if</span> <span class="n">polygon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">createIngrMesh</span><span class="p">(</span><span class="n">ingredient</span><span class="p">)</span>
                <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">mesh_3d</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Meshs_&quot;</span> <span class="o">+</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingredient</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="c1">#                    self.vi.AddObject(parent)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingredient</span><span class="p">,</span> <span class="s2">&quot;ipoly&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">ipoly</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">principal_vector</span><span class="p">[:])</span>
                <span class="c1">#                if self.vi.host.find(&quot;blender&quot;) != -1 and self.vi.instance_dupliFace and ingredient.coordsystem == &quot;left&quot;:</span>
                <span class="c1">#                            if self.helper.getType(self.helper.getChilds(polygon)[0]) != self.helper.EMPTY:</span>
                <span class="c1">#                    axis = self.vi.rotatePoint(axis,[0.,0.,0.],[0.0,1.0,0.0,-math.pi/2.0])</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">ipoly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancePolygon</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span> <span class="o">+</span> <span class="n">ingredient</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">matrices</span><span class="o">=</span><span class="n">matrices</span><span class="p">,</span>
                    <span class="n">mesh</span><span class="o">=</span><span class="n">polygon</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                    <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">ingredient</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                    <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayCytoplasmIngredients"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayCytoplasmIngredients">[docs]</a>    <span class="k">def</span> <span class="nf">displayCytoplasmIngredients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doSpheres</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">deepest_level</span>
                <span class="n">px</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">transformPoints</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">])):</span>
                        <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                        <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Cylinders&quot;</span><span class="p">:</span>
                    <span class="n">px2</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">transformPoints</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">positions2</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">])):</span>
                        <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                        <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px2</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                        <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
                        <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
                    <span class="c1">#        ingr.verts = verts[ingr]</span>
                    <span class="c1">#        ingr.rad = radii[ingr]</span>
                    <span class="c1"># display cytoplasm spheres</span>
                    <span class="c1"># if self.doSpheres :#or ingr.mesh is None:</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="c1">#                    self.displayIngrSpheres(ingr,verts,radii)</span>
                    <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrSpheres</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Cylinders&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrCylinders</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># display cytoplasm meshes</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="n">meshGeoms</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># self.meshGeoms#{}</span>
            <span class="n">inds</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">:</span>  <span class="c1"># display mesh</span>
                    <span class="n">mat</span> <span class="o">=</span> <span class="n">rot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">mat</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
                    <span class="c1">#                    if self.helper.host == &#39;dejavu&#39;:</span>
                    <span class="c1">#                        mry90 = self.helper.rotation_matrix(-math.pi/2.0, [0.0,1.0,0.0])#?</span>
                    <span class="c1">#                        mat = numpy.array(numpy.matrix(mat)*numpy.matrix(mry90))</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
                        <span class="n">mat</span> <span class="o">=</span> <span class="n">rot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                        <span class="n">mat</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
                    <span class="k">if</span> <span class="n">ingr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meshGeoms</span><span class="p">:</span>
                        <span class="n">inds</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ptInd</span><span class="p">]</span>
                        <span class="n">meshGeoms</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat</span><span class="p">]</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;mesh_3d&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">createIngrMesh</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
                                <span class="c1"># else :</span>
                                <span class="c1">#    geom.Set(materials=[ingr.color], inheritMaterial=0, visible=0)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">inds</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptInd</span><span class="p">)</span>
                        <span class="n">meshGeoms</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
                        <span class="c1"># if self.ViewerType == &#39;dejavu&#39;:</span>
                        <span class="c1">#    self.vi.AddObject(geom, parent=self.orgaToMasterGeom[ingr])</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Meshs_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">ingr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meshGeoms</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ingr not in meshGeoms&quot;</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">meshGeoms</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">principal_vector</span><span class="p">[:])</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">ipoly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancePolygon</span><span class="p">(</span>
                    <span class="s2">&quot;cyto_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">o_name</span><span class="p">,</span>
                    <span class="n">matrices</span><span class="o">=</span><span class="n">meshGeoms</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                    <span class="n">mesh</span><span class="o">=</span><span class="n">polygon</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                    <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                    <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="n">polygon</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span><span class="n">polygon</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># and do it for child too.</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;softimage&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">ipoly</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span><span class="p">:</span>
                            <span class="k">return</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ip</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">ipoly</span><span class="p">):</span>
                            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">inds</span><span class="p">[</span><span class="n">ingr</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span>
                                    <span class="n">ip</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">order</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">ingr</span><span class="p">][</span><span class="n">i</span><span class="p">]]),</span>
                                <span class="p">)</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="AutopackViewer.displayCompartmentsIngredients"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayCompartmentsIngredients">[docs]</a>    <span class="k">def</span> <span class="nf">displayCompartmentsIngredients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># display compartment ingredients</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="c1"># Sphere and Cylinders</span>
            <span class="n">verts</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">radii</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfaceRecipe</span>
            <span class="k">if</span> <span class="n">rs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">rs</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ri</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">innerRecipe</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doSpheres</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ri</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                        <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="n">orga</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">deepest_level</span>
                    <span class="n">px</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">transformPoints</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">])):</span>
                            <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                            <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Cylinders&quot;</span><span class="p">:</span>
                        <span class="n">px2</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">transformPoints</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">positions2</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">])):</span>
                            <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                            <span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">px2</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                            <span class="n">radii</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">ii</span><span class="p">])</span>
                        <span class="c1">#                            radii[ingr].append( ingr.radii[level][ii] )</span>

                        <span class="c1"># if self.doSpheres :</span>
                <span class="k">if</span> <span class="n">rs</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">rs</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]):</span>
                            <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrSpheres</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Cylinders&quot;</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrCylinders</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ri</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">[</span><span class="n">ingr</span><span class="p">]):</span>
                            <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrSpheres</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Cylinders&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">displayIngrCylinders</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Meshs</span>
            <span class="n">matrices</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfaceRecipe</span>
            <span class="c1">#            if rs :</span>
            <span class="c1">#                for ingr in rs.ingredients:</span>
            <span class="c1">#                    if ingr.mesh: # display mesh</span>
            <span class="c1">#                        self.displayIngrMesh(matrices,ingr)</span>
            <span class="c1">#            ri =  orga.innerRecipe</span>
            <span class="c1">#            if ri :</span>
            <span class="c1">#                for ingr in ri.ingredients:</span>
            <span class="c1">#                    if ingr.mesh: # display mesh</span>
            <span class="c1">#                        self.displayIngrMesh(matrices,ingr)</span>
            <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="n">orga</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">:</span>  <span class="c1"># display mesh</span>
                    <span class="n">mat</span> <span class="o">=</span> <span class="n">rot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">mat</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
                        <span class="n">mat</span> <span class="o">=</span> <span class="n">rot</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                        <span class="n">mat</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span>
                    <span class="k">if</span> <span class="n">ingr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">matrices</span><span class="p">:</span>
                        <span class="n">matrices</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">matrices</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="s2">&quot;mesh_3d&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                            <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">createIngrMesh</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nbMAtrices&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrices</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">ri</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">:</span>
                        <span class="c1">#                        self.vi.progressBar(j/ningri,label=&quot;instances for &quot;+str(j)+&quot; &quot;+ingr.name+&quot; &quot;+str(len(matrices[ingr])))</span>
                        <span class="c1"># geom.Set(instanceMatrices=matrices[ingr], visible=1)</span>
                        <span class="c1">#                        if self.ViewerType != &#39;dejavu&#39;:</span>
                        <span class="c1"># find the polygon and the ingr?#polygon = ingr.mesh_3d</span>
                        <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Meshs_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                        <span class="c1"># check if alive ?</span>
                        <span class="k">if</span> <span class="n">ingr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">matrices</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                                <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
                            <span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                            <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ri instanciation of polygon&quot;</span><span class="p">,</span> <span class="n">polygon</span><span class="p">)</span>
                        <span class="n">axis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">principal_vector</span><span class="p">[:])</span>
                        <span class="c1">#                        if self.vi.host.find(&quot;blender&quot;) != -1 and self.vi.instance_dupliFace and ingr.coordsystem == &quot;left&quot;:</span>
                        <span class="c1">#                            if self.helper.getType(self.helper.getChilds(polygon)[0]) != self.helper.EMPTY:</span>
                        <span class="c1">#                            axis = self.vi.rotatePoint(axis,[0.,0.,0.],[0.0,1.0,0.0,-math.pi/2.0])</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">ipoly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancePolygon</span><span class="p">(</span>
                            <span class="n">orga</span><span class="o">.</span><span class="n">name</span>
                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">matrices</span><span class="o">=</span><span class="n">matrices</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                            <span class="n">mesh</span><span class="o">=</span><span class="n">polygon</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                            <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                            <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="c1"># principal vector rotate by 90degree for blender dupliVert?</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="n">polygon</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span>
                                    <span class="n">polygon</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="p">)</span>  <span class="c1"># and do it for child too.</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;softimage&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span>
                                <span class="n">ingr</span>
                            <span class="p">]</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span>  <span class="c1"># self.getMasterInstance(polygon)</span>
                            <span class="c1"># polygon already an instance from a different object\</span>

                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">rs</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">rs</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">:</span>
                        <span class="c1">#                        geom.Set(instanceMatrices=meshGeoms[ingr], visible=1)</span>
                        <span class="c1">#                        if self.ViewerType != &#39;dejavu&#39;:</span>
                        <span class="c1"># find the polygon and the ingr?#polygon = ingr.mesh_3d</span>
                        <span class="n">polygon</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh_3d</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Meshs_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">ingr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">matrices</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                                <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="c1">#                            self.vi.AddObject(parent)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                            <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rs instanciation of polygon&quot;</span><span class="p">,</span> <span class="n">polygon</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
                        <span class="n">axis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">principal_vector</span><span class="p">[:])</span>
                        <span class="c1">#                        if self.vi.host.find(&quot;blender&quot;) != -1 and self.vi.instance_dupliFace and ingr.coordsystem == &quot;left&quot;:</span>
                        <span class="c1">#                            if self.helper.getType(self.helper.getChilds(polygon)[0]) != self.helper.EMPTY:</span>
                        <span class="c1">#                            axis = self.vi.rotatePoint(axis,[0.,0.,0.],[0.0,1.0,0.0,-math.pi/2.0])</span>
                        <span class="c1">#                                print (self.helper.getType(self.helper.getChilds(polygon)[0]))</span>
                        <span class="n">ingr</span><span class="o">.</span><span class="n">ipoly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancePolygon</span><span class="p">(</span>
                            <span class="n">orga</span><span class="o">.</span><span class="n">name</span>
                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">FillName</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">cFill</span><span class="p">]</span>
                            <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">matrices</span><span class="o">=</span><span class="n">matrices</span><span class="p">[</span><span class="n">ingr</span><span class="p">],</span>
                            <span class="n">mesh</span><span class="o">=</span><span class="n">polygon</span><span class="p">,</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
                            <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                            <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="n">polygon</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">setLayers</span><span class="p">(</span>
                                    <span class="n">polygon</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="p">)</span>  <span class="c1"># and do it for child too.</span>

                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span>
                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="AutopackViewer.appendIngrInstance"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.appendIngrInstance">[docs]</a>    <span class="k">def</span> <span class="nf">appendIngrInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">sel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bb</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getCurrentSelection</span><span class="p">()</span>
        <span class="c1"># should have a parent and take all children or take all selection</span>
        <span class="c1"># what about the ptId</span>
        <span class="c1"># molecules is [pos, rot, ingr, ptInd]</span>
        <span class="c1"># whats the compartiments, so the ingr have to be reviously add to a compartiments</span>
        <span class="n">orga</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>  <span class="c1"># what if it is cytoplsme?</span>
        <span class="c1"># res = o.molecules[:]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">boundingBox</span>
            <span class="n">spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">smallestProteinSize</span> <span class="o">*</span> <span class="mf">1.1547</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">nb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">computeGridNumberOfPoint</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="n">spacing</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">EMPTY</span><span class="p">:</span>
                <span class="n">childs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
                    <span class="c1">#                    name = self.helper.getName(ch)</span>
                    <span class="n">rotMatj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMatRotation</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                    <span class="n">jtrans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">ToVec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getTranslation</span><span class="p">(</span><span class="n">ch</span><span class="p">))</span>
                    <span class="n">ptId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">getPointFrom3D</span><span class="p">(</span><span class="n">jtrans</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">spacing</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">jtrans</span><span class="p">,</span> <span class="n">rotMatj</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptId</span><span class="p">])</span>
                <span class="c1"># need to handle the PtID none</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rotMatj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMatRotation</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
                <span class="n">jtrans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">ToVec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getTranslation</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>
                <span class="n">ptId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">getPointFrom3D</span><span class="p">(</span><span class="n">jtrans</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">spacing</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">jtrans</span><span class="p">,</span> <span class="n">rotMatj</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptId</span><span class="p">])</span>
        <span class="n">ingr</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">orga</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayFreePoints"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayFreePoints">[docs]</a>    <span class="k">def</span> <span class="nf">displayFreePoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vDebug</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c1"># display grid points with positive distances left</span>
        <span class="n">vertsFreePts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vertsAll</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Graham debugTrashLine</span>
        <span class="n">verts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rads</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">fpts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">freePointsAfterFill</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">nbFreePointsAfterFill</span><span class="p">]</span>
        <span class="n">NPTS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">)</span>  <span class="c1"># or self.histo.grid.gridVolume</span>
        <span class="c1">#        for pt in self.histo.freePointsAfterFill[:self.histo.nbFreePointsAfterFill]:</span>
        <span class="c1">#        for pt in self.histo.freePointsAfterFill:</span>
        <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NPTS</span><span class="p">):</span>
            <span class="n">vertsAll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">pt</span><span class="p">])</span>  <span class="c1"># Graham debugTrashLine</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">distancesAfterFill</span><span class="p">[</span><span class="n">pt</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">smallestProteinSize</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">:</span>
                <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">pt</span><span class="p">])</span>
                <span class="n">rads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">):</span>
                <span class="n">sph1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Spheres</span><span class="p">(</span>
                    <span class="s2">&quot;unusedSph&quot;</span><span class="p">,</span>
                    <span class="n">centers</span><span class="o">=</span><span class="n">verts</span><span class="p">,</span>
                    <span class="n">radii</span><span class="o">=</span><span class="n">rads</span><span class="p">,</span>
                    <span class="n">inheritFrontPolyMode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">frontPolyMode</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">sph1</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">):</span>

            <span class="n">verts0</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vertsIn</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vertsOut</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NPTS</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">distancesAfterFill</span><span class="p">[</span><span class="n">pt</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">verts0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">pt</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">vertsIn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">pt</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">vertsOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">pt</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">fpts</span><span class="p">:</span>
                <span class="n">vertsFreePts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[</span><span class="n">pt</span><span class="p">])</span>

            <span class="n">vDebug</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Aug 19, 2012: Set vDebug = 1 if you want the grids to be at top of hierarchy for easy access</span>
            <span class="n">vParent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>
            <span class="k">if</span> <span class="n">vDebug</span><span class="p">:</span>
                <span class="n">vParent</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">vGridPointHider</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;GridPointHider&quot;</span><span class="p">)</span>  <span class="c1"># g</span>
            <span class="k">if</span> <span class="n">vGridPointHider</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># g</span>
                <span class="n">vGridPointHider</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;GridPointHider&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">vParent</span>
                <span class="p">)</span>
            <span class="c1"># if self.ViewerType != &#39;dejavu&#39;:</span>
            <span class="c1">#    #define the base shape for instance objects</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">psph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">vParentHiders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;ParentHiders&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">psph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;base_shape&quot;</span><span class="p">,</span>
                    <span class="n">parent</span><span class="o">=</span><span class="n">vParentHiders</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Points</span><span class="p">(</span>
                <span class="s2">&quot;allDistPts&quot;</span><span class="p">,</span>
                <span class="n">vertices</span><span class="o">=</span><span class="n">vertsAll</span><span class="p">,</span>
                <span class="n">inheritPointWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Graham debugTrashLine</span>
                <span class="n">pointWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pointWidth</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[</span><span class="n">upyColors</span><span class="o">.</span><span class="n">blue</span><span class="p">],</span>
                <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">vGridPointHider</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">pts0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Points</span><span class="p">(</span>
                <span class="s2">&quot;zeroDistPts&quot;</span><span class="p">,</span>
                <span class="n">vertices</span><span class="o">=</span><span class="n">verts0</span><span class="p">,</span>
                <span class="n">inheritPointWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">pointWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pointWidth</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
                <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">vGridPointHider</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1">#            verts = []</span>
            <span class="c1">#            for pt in fpts:#[:self.histo.nbFreePointsAfterFill]:</span>
            <span class="c1">#                d = self.histo.distancesAfterFill[pt]</span>
            <span class="c1">#                if d&gt;0:</span>
            <span class="c1">#                    verts.append(self.histo.masterGridPositions[pt])</span>

            <span class="n">unUspts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Points</span><span class="p">(</span>
                <span class="s2">&quot;UnusedGridPoints&quot;</span><span class="p">,</span>
                <span class="n">vertices</span><span class="o">=</span><span class="n">vertsOut</span><span class="p">,</span>
                <span class="n">inheritPointWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">pointWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pointWidth</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[</span><span class="n">upyColors</span><span class="o">.</span><span class="n">green</span><span class="p">],</span>
                <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">vGridPointHider</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Points</span><span class="p">(</span>
                <span class="s2">&quot;FreePoints&quot;</span><span class="p">,</span>
                <span class="n">vertices</span><span class="o">=</span><span class="n">vertsFreePts</span><span class="p">,</span>
                <span class="n">inheritPointWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Graham debugTrashLine</span>
                <span class="n">pointWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pointWidth</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[</span><span class="n">upyColors</span><span class="o">.</span><span class="n">orange</span><span class="p">],</span>
                <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">vGridPointHider</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1">#            verts = []</span>
            <span class="c1">#            for pt in fpts:#[self.histo.nbFreePointsAfterFill:]:</span>
            <span class="c1">#                d = self.histo.distancesAfterFill[pt]</span>
            <span class="c1">#                if d&lt;=0:</span>
            <span class="c1">#                    verts.append(self.histo.masterGridPositions[pt])</span>

            <span class="n">Uspts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Points</span><span class="p">(</span>
                <span class="s2">&quot;UsedGridPoints&quot;</span><span class="p">,</span>
                <span class="n">vertices</span><span class="o">=</span><span class="n">vertsIn</span><span class="p">,</span>
                <span class="n">inheritPointWidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">pointWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pointWidth</span><span class="p">,</span>
                <span class="n">inheritMaterial</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">materials</span><span class="o">=</span><span class="p">[</span><span class="n">upyColors</span><span class="o">.</span><span class="n">red</span><span class="p">],</span>
                <span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">vGridPointHider</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">==</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
                <span class="c1">#              self.vi.AddObject(ptsAll)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">pts0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">unUspts</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">Uspts</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.dspMesh"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.dspMesh">[docs]</a>    <span class="k">def</span> <span class="nf">dspMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geom</span><span class="p">):</span>
        <span class="c1"># specific to C4D</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetDown</span><span class="p">()():</span>
                <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Meshs&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;mesh&quot;</span><span class="p">:</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.undspMesh"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.undspMesh">[docs]</a>    <span class="k">def</span> <span class="nf">undspMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geom</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetDown</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Meshs&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;mesh&quot;</span><span class="p">:</span>
                    <span class="n">c</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.dspSph"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.dspSph">[docs]</a>    <span class="k">def</span> <span class="nf">dspSph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geom</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetDown</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;spheres&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;spheres&quot;</span><span class="p">:</span>
                    <span class="n">ch</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.undspSph"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.undspSph">[docs]</a>    <span class="k">def</span> <span class="nf">undspSph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geom</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewerType</span> <span class="o">!=</span> <span class="s2">&quot;dejavu&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">GetDown</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">GetName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;spheres&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">toggleDisplay</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">geom</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;spheres&quot;</span><span class="p">:</span>
                    <span class="n">ch</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.showHide"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.showHide">[docs]</a>    <span class="k">def</span> <span class="nf">showHide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                <span class="n">master</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
                <span class="n">func</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">orga</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">surfaceRecipe</span>
            <span class="k">if</span> <span class="n">rs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">rs</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="n">master</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
                    <span class="n">func</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
            <span class="n">ri</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">innerRecipe</span>
            <span class="k">if</span> <span class="n">ri</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">ri</span><span class="o">.</span><span class="n">ingredients</span><span class="p">:</span>
                    <span class="n">master</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span>
                    <span class="n">func</span><span class="p">(</span><span class="n">master</span><span class="p">)</span></div>
                    <span class="c1"># ==============================================================================</span>
                <span class="c1"># custom filling</span>
                <span class="c1"># ==============================================================================</span>

<div class="viewcode-block" id="AutopackViewer.checkCreateEmpty"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.checkCreateEmpty">[docs]</a>    <span class="k">def</span> <span class="nf">checkCreateEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">empty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">empty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">empty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">empty</span></div>

<div class="viewcode-block" id="AutopackViewer.createTemplate"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.createTemplate">[docs]</a>    <span class="k">def</span> <span class="nf">createTemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepareMaster</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">displayEnv</span><span class="p">()</span>
        <span class="n">setup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Setup&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_compartments_geometries&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">setup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="s2">&quot;Place here your compartments geometries&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_cytoplasm_ingredient&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">setup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="s2">&quot;Place here your cytoplasm ingredients&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_compartments_recipes&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">setup</span><span class="p">)</span></div>
        <span class="c1"># s = self.checkCreateEmpty(&#39;Setup following the template&#39;, parent=g)</span>
        <span class="c1"># r = self.checkCreateEmpty(&#39;compartmentname_recipe&#39;, parent=g)</span>
        <span class="c1"># rs = self.checkCreateEmpty(&#39;compartmentname_surface&#39;, parent=r)</span>
        <span class="c1"># ingrorga = self.checkCreateEmpty(&quot;Place here your surface ingredients&quot;, parent=rs)</span>
        <span class="c1"># ri = self.checkCreateEmpty(&#39;compartmentname_interior&#39;, parent=r)</span>
        <span class="c1"># ingrorga = self.checkCreateEmpty(&quot;Place here your interior ingredients&quot;, parent=ri)</span>

<div class="viewcode-block" id="AutopackViewer.createTemplateCompartment"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.createTemplateCompartment">[docs]</a>    <span class="k">def</span> <span class="nf">createTemplateCompartment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">organame</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_compartments_recipes&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="n">organame</span> <span class="o">+</span> <span class="s2">&quot;_recipe&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="c1"># reparent the mesh</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">organame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">reParent</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

        <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="n">organame</span> <span class="o">+</span> <span class="s2">&quot;_surface&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
            <span class="s2">&quot;Place here your surface ingredients &quot;</span> <span class="o">+</span> <span class="n">organame</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">rs</span>
        <span class="p">)</span>

        <span class="n">ri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span><span class="n">organame</span> <span class="o">+</span> <span class="s2">&quot;_interior&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkCreateEmpty</span><span class="p">(</span>
            <span class="s2">&quot;Place here your interior ingredients&quot;</span> <span class="o">+</span> <span class="n">organame</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">ri</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.addIngredientFromGeom"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.addIngredientFromGeom">[docs]</a>    <span class="k">def</span> <span class="nf">addIngredientFromGeom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ingrobj</span><span class="p">,</span> <span class="n">recipe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;######ADD&quot;</span><span class="p">,</span>
            <span class="n">ingrobj</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">ingrobj</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">ingrobj</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">ingr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ingrobj</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">ingrobj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">INSTANCE</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMasterInstance</span><span class="p">(</span><span class="n">ingrobj</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">EMPTY</span><span class="p">:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">nchilds</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
            <span class="c1"># the ingredient is composed by theses different childs that ca be n sphere n cylinder 1 cube, and n instance of ...</span>
            <span class="c1"># which is a spheretree, or a cylindertree</span>
            <span class="c1"># get the first one to recognized the type</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">nchilds</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PROBLEM&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">child0</span> <span class="o">=</span> <span class="n">child</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ingtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">child0</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;first child is &quot;</span><span class="p">,</span> <span class="n">ingtype</span><span class="p">,</span> <span class="n">nchilds</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ingtype</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">INSTANCE</span><span class="p">:</span>
                <span class="n">child0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMasterInstance</span><span class="p">(</span><span class="n">child0</span><span class="p">)</span>
                <span class="n">ingtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">child0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">ingtype</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">SPHERE</span>
            <span class="p">):</span>  <span class="c1"># should be able to detect this using distance vertex-&gt;center</span>

                <span class="n">positions</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">io</span> <span class="ow">in</span> <span class="n">child</span><span class="p">:</span>
                    <span class="c1"># get the radius and the translation</span>
                    <span class="c1"># should all be sphere but check anyway</span>
                    <span class="c1"># also this compute the radius property of the sphere in blender.</span>
                    <span class="n">atype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">atype</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">SPHERE</span> <span class="ow">and</span> <span class="n">atype</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">INSTANCE</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">pos</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span>
                        <span class="n">io</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pos&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;radius&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">INSTANCE</span><span class="p">:</span>
                        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMasterInstance</span><span class="p">(</span><span class="n">io</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">]</span>
                        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
                    <span class="n">radius</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># should be one</span>
                <span class="c1">#                    self.helper.Sphere(self.helper.getName(io)+&quot;_sp&quot;,radius=r)</span>
                <span class="n">ingr</span> <span class="o">=</span> <span class="n">MultiSphereIngr</span><span class="p">(</span>
                    <span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">radii</span><span class="o">=</span><span class="p">[</span><span class="n">radius</span><span class="p">],</span>
                    <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="n">positions</span><span class="p">],</span>
                    <span class="n">meshObject</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">ingtype</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">CYLINDER</span><span class="p">:</span>

                <span class="n">positions</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">positions2</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span><span class="n">child</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;axis&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">io</span> <span class="ow">in</span> <span class="n">child</span><span class="p">:</span>
                    <span class="c1"># get the radius and the translation</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">INSTANCE</span><span class="p">:</span>
                        <span class="n">io</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMasterInstance</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">head</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">CylinderHeadTails</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
                    <span class="n">positions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
                    <span class="n">positions2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
                    <span class="n">radius</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1">#                    self.helper.oneCylinder(self.helper.getName(io)+&quot;_cyl&quot;,head,tail,radius=r)</span>
                <span class="n">ingr</span> <span class="o">=</span> <span class="n">MultiCylindersIngr</span><span class="p">(</span>
                    <span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">radii</span><span class="o">=</span><span class="p">[</span><span class="n">radius</span><span class="p">],</span>
                    <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">)],</span>
                    <span class="n">positions2</span><span class="o">=</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions2</span><span class="p">)],</span>
                    <span class="n">meshObject</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
                    <span class="n">principal_vector</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">ingtype</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">CUBE</span><span class="p">:</span>

                <span class="c1"># need to create a SphereIngredient</span>
                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span><span class="n">child0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">child0</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">INSTANCE</span><span class="p">:</span>
                    <span class="n">child0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMasterInstance</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
                <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span><span class="n">child0</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ingr</span> <span class="o">=</span> <span class="n">SingleCubeIngr</span><span class="p">(</span>
                    <span class="mf">1.0</span><span class="p">,</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">ToVec</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">positions</span><span class="o">=</span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]],</span>
                    <span class="n">meshObject</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">SPHERE</span><span class="p">:</span>

            <span class="c1"># need to create a SphereIngredient</span>
            <span class="n">ingr</span> <span class="o">=</span> <span class="n">SingleSphereIngr</span><span class="p">(</span>
                <span class="mf">1.0</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span>
                <span class="c1">#                    meshFile=wrkDir+&#39;/&#39;+k+&#39;/&#39;+ing_name,</span>
                <span class="n">meshObject</span><span class="o">=</span><span class="n">ingrobj</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># compartiment ?</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">CYLINDER</span><span class="p">:</span>

            <span class="c1"># need to create a SphereIngredient</span>
            <span class="n">r</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span>
                <span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;radius&quot;</span><span class="p">,</span> <span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="s2">&quot;axis&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">ingr</span> <span class="o">=</span> <span class="n">MultiCylindersIngr</span><span class="p">(</span>
                <span class="mf">1.0</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">radii</span><span class="o">=</span><span class="p">[[</span><span class="n">r</span><span class="p">]],</span>
                <span class="n">positions</span><span class="o">=</span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">h</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]],</span>
                <span class="n">positions2</span><span class="o">=</span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]],</span>
                <span class="n">meshObject</span><span class="o">=</span><span class="n">ingrobj</span><span class="p">,</span>
                <span class="c1">#                max_jitter=(1.,1.,1.),#how to customize</span>
                <span class="c1">#                rotation_axis=(0.,0.,1.0),#how to customize</span>
                <span class="c1">#                jitter_attempts = 10,</span>
                <span class="c1">#  CRITICAL !!! IF jitter is greater than radius of object,</span>
                <span class="c1"># e.g. 5x(1,1,1) the point may not be consumed!!!</span>
                <span class="n">principal_vector</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>  <span class="c1"># should come from the object</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">CUBE</span><span class="p">:</span>

            <span class="c1"># need to create a SphereIngredient</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getPropertyObject</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ingr</span> <span class="o">=</span> <span class="n">SingleCubeIngr</span><span class="p">(</span>
                <span class="mf">1.0</span><span class="p">,</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">ToVec</span><span class="p">(</span><span class="n">size</span><span class="p">)],</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">positions</span><span class="o">=</span><span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]],</span>
                <span class="n">meshObject</span><span class="o">=</span><span class="n">ingrobj</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="n">ingr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">recipe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span><span class="o">.</span><span class="n">addIngredient</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">compNum</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_cytoplasm&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addMasterIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">g</span><span class="p">)</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">addIngredient</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">compNum</span> <span class="o">=</span> <span class="n">recipe</span><span class="o">.</span><span class="n">number</span>
                <span class="c1"># g = self.vi.getObject(&quot;O&quot; + o.name)</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span>
            <span class="n">rep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">o_name</span> <span class="o">+</span> <span class="s2">&quot;_mesh&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">o_name</span> <span class="o">+</span> <span class="s2">&quot;_mesh is&quot;</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">rep</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">meshFile</span> <span class="o">=</span> <span class="n">autopack</span><span class="o">.</span><span class="n">cache_geoms</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">o_name</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">meshName</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">o_name</span> <span class="o">+</span> <span class="s2">&quot;_mesh&quot;</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">saveDejaVuMesh</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">meshFile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addMasterIngr</span><span class="p">(</span><span class="n">ingr</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">compNum</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ingr</span></div>

<div class="viewcode-block" id="AutopackViewer.addCompartmentFromGeom"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.addCompartmentFromGeom">[docs]</a>    <span class="k">def</span> <span class="nf">addCompartmentFromGeom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="c1"># note in blender everything is mesh</span>
        <span class="kn">from</span> <span class="nn">autopack.Compartment</span> <span class="kn">import</span> <span class="n">Compartment</span>

        <span class="n">o1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADD ORGA&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;blender&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="n">nname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;name blender org&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">faces</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">vnormals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">DecomposeMesh</span><span class="p">(</span>
                <span class="n">comp</span><span class="p">,</span> <span class="n">edit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">o1</span> <span class="o">=</span> <span class="n">Compartment</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">vnormals</span><span class="p">)</span>
            <span class="n">o1</span><span class="o">.</span><span class="n">overwriteSurfacePts</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">EMPTY</span>
        <span class="p">):</span>  <span class="c1"># Compartment master parent?</span>
            <span class="n">childs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
                <span class="n">chname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;maya&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">chname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Shape&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="n">chname</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">chname</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;name 1 org&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">EMPTY</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                    <span class="c1"># should be all polygon</span>
                    <span class="n">faces</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">vertices</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">vnormals</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">pc</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
                        <span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">vn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">DecomposeMesh</span><span class="p">(</span>
                            <span class="n">pc</span><span class="p">,</span> <span class="n">edit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span>
                        <span class="p">)</span>
                        <span class="n">faces</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                        <span class="n">vertices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                        <span class="n">vnormals</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">vn</span><span class="p">)</span>
                    <span class="n">o1</span> <span class="o">=</span> <span class="n">Compartment</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">vnormals</span><span class="p">)</span>
                    <span class="n">o1</span><span class="o">.</span><span class="n">overwriteSurfacePts</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">POLYGON</span><span class="p">:</span>
                    <span class="c1"># each childs is polygin -&gt;compartment</span>
                    <span class="n">faces</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">vnormals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">DecomposeMesh</span><span class="p">(</span>
                        <span class="n">ch</span><span class="p">,</span> <span class="n">edit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>
                    <span class="n">o1</span> <span class="o">=</span> <span class="n">Compartment</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">vnormals</span><span class="p">)</span>
                    <span class="n">o1</span><span class="o">.</span><span class="n">overwriteSurfacePts</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1">#                h1.addCompartment(o1)</span>
                <span class="c1">#                if rSurf.has_key(name):</span>
                <span class="c1">#                    if rSurf[name].ingredients:</span>
                <span class="c1">#                        r  = rSurf[name]</span>
                <span class="c1">#                        o1.setSurfaceRecipe(r)</span>
                <span class="c1">#                if rMatrix.has_key(name):</span>
                <span class="c1">#                    if rMatrix[name].ingredients:</span>
                <span class="c1">#                        r = rMatrix[name]</span>
                <span class="c1">#                        o1.setInnerRecipe(r)</span>
                <span class="c1">#                print o1.name,o1.number</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">POLYGON</span><span class="p">:</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="n">nname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;maya&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nname</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Shape&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">nname</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">nname</span>  <span class="c1"># name = self.helper.getName(obj)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;name 2 org&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="c1"># helper.triangulate(comp)</span>
            <span class="n">faces</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">vnormals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">DecomposeMesh</span><span class="p">(</span>
                <span class="n">comp</span><span class="p">,</span> <span class="n">edit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tri</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">o1</span> <span class="o">=</span> <span class="n">Compartment</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">vnormals</span><span class="p">)</span>
            <span class="n">o1</span><span class="o">.</span><span class="n">overwriteSurfacePts</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">o1</span></div>

    <span class="c1">#            h1.addCompartment(o1)</span>
    <span class="c1">#            if rSurf.has_key(name):</span>
    <span class="c1">#                if rSurf[name].ingredients:</span>
    <span class="c1">#                    r  = rSurf[name]</span>
    <span class="c1">#                    o1.setSurfaceRecipe(r)</span>
    <span class="c1">#            if rMatrix.has_key(name):</span>
    <span class="c1">#                if rMatrix[name].ingredients:</span>
    <span class="c1">#                    r = rMatrix[name]</span>
    <span class="c1">#                    o1.setInnerRecipe(r)</span>

    <span class="c1"># ===============================================================================</span>
    <span class="c1"># color tools</span>
    <span class="c1"># ===============================================================================</span>
<div class="viewcode-block" id="AutopackViewer.color"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.color">[docs]</a>    <span class="k">def</span> <span class="nf">color</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span>
        <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">parents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">upyColors</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">black</span><span class="p">],</span>
        <span class="o">**</span><span class="n">options</span>
    <span class="p">):</span>

        <span class="n">mini</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">maxi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">useMaterial</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">useObjectColors</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">listeObjs</span> <span class="o">=</span> <span class="n">objects</span>
        <span class="k">if</span> <span class="s2">&quot;mini&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;mini&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;maxi&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;maxi&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;useMaterial&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">useMaterial</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;useMaterial&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">useMaterial</span><span class="p">:</span>
                <span class="n">useObjectColors</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s2">&quot;useObjectColors&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">useObjectColors</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;useObjectColors&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">useObjectColors</span><span class="p">:</span>
                <span class="n">useMaterial</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">ramp</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">getRamp</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># TODO: check this fix from &quot;datas&quot; to &quot;data&quot; is correct</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;distance&quot;</span><span class="p">:</span>
                <span class="n">listeObjs</span><span class="p">,</span> <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colorByDistanceFrom</span><span class="p">(</span>
                    <span class="n">target</span><span class="p">,</span>
                    <span class="n">parents</span><span class="o">=</span><span class="n">parents</span><span class="p">,</span>
                    <span class="n">distances</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">,</span>
                    <span class="n">ramp</span><span class="o">=</span><span class="n">ramp</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">options</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;order&quot;</span><span class="p">:</span>
                <span class="c1"># the order is in the name</span>
                <span class="n">listeObjs</span><span class="p">,</span> <span class="n">datas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">colorByOrder</span><span class="p">(</span>
                    <span class="n">parents</span><span class="o">=</span><span class="n">parents</span><span class="p">,</span>
                    <span class="n">orders</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">objects</span><span class="o">=</span><span class="n">objects</span><span class="p">,</span>
                    <span class="n">ramp</span><span class="o">=</span><span class="n">ramp</span><span class="p">,</span>
                    <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">options</span>
                <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;datas&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datas</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;objs&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">listeObjs</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">datas</span> <span class="ow">and</span> <span class="n">datas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lcol</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">map_colors</span><span class="p">(</span><span class="n">datas</span><span class="p">,</span> <span class="n">ramp</span><span class="p">,</span> <span class="n">mini</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">io</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">listeObjs</span><span class="p">):</span>
                <span class="c1"># print io</span>
                <span class="n">io</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">useMaterial</span><span class="p">:</span>
                    <span class="c1"># this will add a material if no material</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">changeObjColorMat</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">lcol</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">datas</span><span class="p">,</span> <span class="n">listeObjs</span></div>

    <span class="c1"># export distance ...</span>
<div class="viewcode-block" id="AutopackViewer.colorByDistanceFrom"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.colorByDistanceFrom">[docs]</a>    <span class="k">def</span> <span class="nf">colorByDistanceFrom</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">,</span>
        <span class="n">parents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">distances</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ramp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">upyColors</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">black</span><span class="p">],</span>
        <span class="o">**</span><span class="n">options</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        target : name or host object target</span>
<span class="sd">        Deprecated, need to use new name rule</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get distance from object to the target.</span>
        <span class="c1"># all object are in h.molecules and orga.molecules</span>
        <span class="c1"># get options</span>
        <span class="n">usePoint</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mf">99999.0</span>
        <span class="k">if</span> <span class="s2">&quot;usePoint&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">usePoint</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;usePoint&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;threshold&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ramp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ramp</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">getRamp</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ramp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[[],</span> <span class="p">[]]</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">o</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;target is none&quot;</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[[],</span> <span class="p">[]]</span>
        <span class="n">targetPos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">ToVec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getTranslation</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>  <span class="c1"># hostForm</span>
        <span class="n">listeObjs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">listeDistances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">distances</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get all object except itself,use hierarchy from host</span>
            <span class="c1"># cytoplasme,compartmentname</span>
            <span class="k">if</span> <span class="n">parents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">listeParent</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_cytoplasm&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
                    <span class="n">listeParent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Matrix&quot;</span><span class="p">)</span>
                    <span class="n">listeParent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_surface&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">listeParent</span> <span class="o">=</span> <span class="n">parents</span>
            <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">listeParent</span><span class="p">:</span>
                <span class="n">obparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                <span class="n">childs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">obparent</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
                    <span class="n">ingr_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                    <span class="c1"># ingr_childs = self.vi.getChilds(ch)</span>
                    <span class="n">meshp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">&quot;Meshs_&quot;</span> <span class="o">+</span> <span class="n">ingr_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="c1"># for all instance get the position and measure the distance to target</span>
                    <span class="k">if</span> <span class="n">meshp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
                            <span class="k">continue</span>
                        <span class="n">meshpchilds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span>
                            <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="p">)</span>  <span class="c1"># continue #should get sphere/cylnder parent ?</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">meshpchilds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">meshp</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">meshpchilds</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">ToVec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getTranslation</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">usePoint</span><span class="p">:</span>
                            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">findClosestPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">measure_distance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">targetPos</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                            <span class="n">listeDistances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                            <span class="n">listeObjs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">listeDistances</span> <span class="o">=</span> <span class="n">distances</span>
            <span class="n">listeObjs</span> <span class="o">=</span> <span class="n">objects</span>
        <span class="k">return</span> <span class="n">listeObjs</span><span class="p">,</span> <span class="n">listeDistances</span></div>

<div class="viewcode-block" id="AutopackViewer.colorByOrder"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.colorByOrder">[docs]</a>    <span class="k">def</span> <span class="nf">colorByOrder</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">orders</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">ramp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">upyColors</span><span class="o">.</span><span class="n">red</span><span class="p">,</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">black</span><span class="p">],</span>
        <span class="o">**</span><span class="n">options</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        target : name or host object target</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get distance from object to the target.</span>
        <span class="c1"># all object are in h.molecules and orga.molecules</span>
        <span class="c1"># get options</span>
        <span class="n">orderInName</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mi">999999</span>
        <span class="k">if</span> <span class="s2">&quot;orderInName&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">orderInName</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;orderInName&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;threshold&quot;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ramp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ramp</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">getRamp</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ramp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="n">listeObjs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">listeOrder</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">orders</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">orderInName</span><span class="p">:</span>
                <span class="c1"># get all object except itself,use hierarchy from host</span>
                <span class="c1"># cytoplasme,compartmentname</span>
                <span class="k">if</span> <span class="n">parents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">listeParent</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;cytoplasm&quot;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
                        <span class="n">listeParent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Matrix&quot;</span><span class="p">)</span>
                        <span class="n">listeParent</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_surface&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">listeParent</span> <span class="o">=</span> <span class="n">parents</span>
                <span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">listeParent</span><span class="p">:</span>
                    <span class="n">obparent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;parent&quot;</span><span class="p">,</span> <span class="n">obparent</span><span class="p">)</span>
                    <span class="n">childs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">obparent</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">childs</span><span class="p">:</span>
                        <span class="n">ingr_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ingr&quot;</span><span class="p">,</span> <span class="n">ingr_name</span><span class="p">)</span>
                        <span class="c1"># ingr_childs = self.vi.getChilds(ch)</span>
                        <span class="n">meshp</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">ch</span><span class="p">):</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;Meshs_&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="n">meshp</span> <span class="o">=</span> <span class="n">z</span>
                                <span class="k">break</span>
                        <span class="c1"># meshp = self.vi.getObject(&quot;Meshs_&quot;+ingr_name.split(&quot;_&quot;)[0])</span>
                        <span class="c1"># for all instance get the position and measure the distance to target</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;meshi&quot;</span><span class="p">,</span> <span class="n">meshp</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">meshp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">continue</span>  <span class="c1"># should get sphere/cylnder parent ?</span>
                        <span class="n">meshpchilds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">meshp</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">meshpchilds</span><span class="p">:</span>
                            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getName</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;child order&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                            <span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># first caracter is &quot;n&quot;</span>
                            <span class="k">if</span> <span class="n">order</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                                <span class="n">listeOrder</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
                                <span class="n">listeObjs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># for each mol get the order and color the poly</span>
                <span class="n">inds</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">ingr</span><span class="p">,</span> <span class="n">ptInd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">molecules</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ingr</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">:</span>
                        <span class="n">inds</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ptInd</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">inds</span><span class="p">[</span><span class="n">ingr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptInd</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">listeOrder</span> <span class="o">=</span> <span class="n">orders</span>
            <span class="n">listeObjs</span> <span class="o">=</span> <span class="n">objects</span>
        <span class="k">return</span> <span class="n">listeObjs</span><span class="p">,</span> <span class="n">listeOrder</span></div>

<div class="viewcode-block" id="AutopackViewer.exportIngredient"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.exportIngredient">[docs]</a>    <span class="k">def</span> <span class="nf">exportIngredient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="c1">#        from DejaVu.IndexedPolygons import IndexedPolygons</span>
        <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">meshFile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">meshFile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="c1">#            if isinstance(ingr.mesh,IndexedPolygons):</span>
            <span class="c1">#                ingr.mesh.writeToFile(self.wrkdir+os.sep+ingr.name)</span>
            <span class="c1">#            else :</span>
            <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getMesh</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getType</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">POLYGON</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">writeToFile</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrkdir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; no mesh&quot;</span><span class="p">,</span> <span class="n">ingr</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">ingr</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; mesh already exist: &quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">meshFile</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.exportRecipeIngredients"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.exportRecipeIngredients">[docs]</a>    <span class="k">def</span> <span class="nf">exportRecipeIngredients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipe</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">recipe</span><span class="p">:</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">exportIngredient</span><span class="p">(</span><span class="n">ingr</span><span class="p">)</span> <span class="k">for</span> <span class="n">ingr</span> <span class="ow">in</span> <span class="n">recipe</span><span class="o">.</span><span class="n">ingredients</span><span class="p">]</span></div>

<div class="viewcode-block" id="AutopackViewer.exportAsIndexedMeshs"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.exportAsIndexedMeshs">[docs]</a>    <span class="k">def</span> <span class="nf">exportAsIndexedMeshs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># compartment mesh and ingredient</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">compartments</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">o</span><span class="o">.</span><span class="n">mesh</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">v</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">vn</span><span class="p">,</span> <span class="n">fn</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">vnormals</span><span class="p">,</span> <span class="n">o</span><span class="o">.</span><span class="n">fnormals</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">writeMeshToFile</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">wrkdir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">verts</span><span class="o">=</span><span class="n">v</span><span class="p">,</span>
                    <span class="n">faces</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                    <span class="n">vnorms</span><span class="o">=</span><span class="n">vn</span><span class="p">,</span>
                    <span class="n">fnorms</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">writeToFile</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrkdir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">o</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportRecipeIngredients</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">surfaceRecipe</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportRecipeIngredients</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">innerRecipe</span><span class="p">)</span>
        <span class="c1"># ingredients in out recipe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportRecipeIngredients</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">exteriorRecipe</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayParticleVolumeDistance"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayParticleVolumeDistance">[docs]</a>    <span class="k">def</span> <span class="nf">displayParticleVolumeDistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
        <span class="n">helper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span>
        <span class="kn">import</span> <span class="nn">c4d</span>

        <span class="n">doc</span> <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">documents</span><span class="o">.</span><span class="n">GetActiveDocument</span><span class="p">()</span>
        <span class="n">PS</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">GetParticleSystem</span><span class="p">()</span>
        <span class="n">PS</span><span class="o">.</span><span class="n">FreeAllParticles</span><span class="p">()</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
        <span class="n">PS</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">particle</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">)</span>
        <span class="n">life</span> <span class="o">=</span> <span class="p">[</span><span class="n">c4d</span><span class="o">.</span><span class="n">BaseTime</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">N</span>
        <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">PS</span><span class="o">.</span><span class="n">SetLife</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">life</span><span class="p">))</span>  <span class="c1"># should avoid map</span>
        <span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="n">c4d</span><span class="o">.</span><span class="n">BaseTime</span><span class="p">((</span><span class="n">d</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">distance</span><span class="p">]</span>
        <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">PS</span><span class="o">.</span><span class="n">SetAge</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">ages</span><span class="p">))</span>  <span class="c1"># should avoid map</span>
        <span class="c1">#        #render ?</span>
        <span class="c1">#        #render(&quot;md%.4d&quot; % i,640,480)</span>
        <span class="c1">#        name = &quot;/Users/ludo/DEV/AutoFill/TestSnake/render/renderdistance&quot;</span>
        <span class="n">render</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">render</span><span class="p">:</span>
            <span class="n">rd</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">GetActiveRenderData</span><span class="p">()</span><span class="o">.</span><span class="n">GetData</span><span class="p">()</span>
            <span class="n">bmp</span> <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">bitmaps</span><span class="o">.</span><span class="n">BaseBitmap</span><span class="p">()</span>
            <span class="c1"># Initialize the bitmap with the result size.</span>
            <span class="c1"># The resolution must match with the output size of the render settings.</span>
            <span class="n">bmp</span><span class="o">.</span><span class="n">Init</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
            <span class="c1">#        fps = doc.GetFps()</span>
            <span class="c1">#        next = c4d.BaseTime(self.i/fps)</span>
            <span class="c1">#        doc.SetTime(bc2)</span>
            <span class="n">c4d</span><span class="o">.</span><span class="n">documents</span><span class="o">.</span><span class="n">RenderDocument</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">bmp</span><span class="p">,</span> <span class="n">c4d</span><span class="o">.</span><span class="n">RENDERFLAGS_EXTERNAL</span><span class="p">)</span>
            <span class="n">c4d</span><span class="o">.</span><span class="n">CallCommand</span><span class="p">(</span><span class="mi">12414</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayFreePointsAsPS"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayFreePointsAsPS">[docs]</a>    <span class="k">def</span> <span class="nf">displayFreePointsAsPS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.histo.freePointsAfterFill[:self.histo.nbFreePointsAfterFill]</span>
        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">nbFreePointsAfterFill</span>
        <span class="n">helper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span>
        <span class="kn">import</span> <span class="nn">c4d</span>

        <span class="n">doc</span> <span class="o">=</span> <span class="n">c4d</span><span class="o">.</span><span class="n">documents</span><span class="o">.</span><span class="n">GetActiveDocument</span><span class="p">()</span>
        <span class="n">PS</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">GetParticleSystem</span><span class="p">()</span>
        <span class="n">PS</span><span class="o">.</span><span class="n">FreeAllParticles</span><span class="p">()</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
        <span class="n">gridC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">masterGridPositions</span>
        <span class="n">pts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">freePointsAfterFill</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">gridC</span><span class="p">[</span><span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">PS</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">particle</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="n">life</span> <span class="o">=</span> <span class="p">[</span><span class="n">c4d</span><span class="o">.</span><span class="n">BaseTime</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">N</span>
        <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">PS</span><span class="o">.</span><span class="n">SetLife</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="n">life</span><span class="p">))</span></div>

<div class="viewcode-block" id="AutopackViewer.displayLeafOctree"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayLeafOctree">[docs]</a>    <span class="k">def</span> <span class="nf">displayLeafOctree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">isLeafNode</span><span class="p">:</span>
            <span class="n">onode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">box</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">center</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="p">),</span>
                <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">size</span><span class="p">],</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># go throuhg all node and do a box</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cnode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">branches</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayLeafOctree</span><span class="p">(</span><span class="s2">&quot;node&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">),</span> <span class="n">node</span><span class="p">,</span> <span class="n">ind</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">onode</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayOneNodeOctree"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayOneNodeOctree">[docs]</a>    <span class="k">def</span> <span class="nf">displayOneNodeOctree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">onode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">box</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="p">),</span>
            <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">size</span><span class="p">],</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">isLeafNode</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="c1"># go throuhg all node and do a box</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cnode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">branches</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displayOneNodeOctree</span><span class="p">(</span>
                    <span class="s2">&quot;node&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counter</span><span class="p">),</span> <span class="n">node</span><span class="p">,</span> <span class="n">ind</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">onode</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayOctree"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayOctree">[docs]</a>    <span class="k">def</span> <span class="nf">displayOctree</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># display the octree if any</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">octree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># box(self,name,center=[0.,0.,0.],size=[1.,1.,1.]</span>
        <span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">octree</span><span class="o">.</span><span class="n">root</span>
        <span class="n">oroot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">box</span><span class="p">(</span>
            <span class="s2">&quot;octreeRoot&quot;</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">position</span><span class="p">),</span>
            <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">root</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">size</span><span class="p">],</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># go throuhg all node and do a box</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">branches</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayOneNodeOctree</span><span class="p">(</span><span class="s2">&quot;node&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">oroot</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayOctreeLeaf"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayOctreeLeaf">[docs]</a>    <span class="k">def</span> <span class="nf">displayOctreeLeaf</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># display the octree if any</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">octree</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># box(self,name,center=[0.,0.,0.],size=[1.,1.,1.]</span>
        <span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">octree</span><span class="o">.</span><span class="n">root</span>
        <span class="n">oroot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">box</span><span class="p">(</span>
            <span class="s2">&quot;octreeRoot&quot;</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">position</span><span class="p">),</span>
            <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">root</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">size</span><span class="p">],</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># go throuhg all node and do a box only for leaf</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">branches</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displayLeafOctree</span><span class="p">(</span><span class="s2">&quot;node&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">node</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">oroot</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.delIngr"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.delIngr">[docs]</a>    <span class="k">def</span> <span class="nf">delIngr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="n">ingrname</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span>
        <span class="n">parentname</span> <span class="o">=</span> <span class="s2">&quot;Meshs_&quot;</span> <span class="o">+</span> <span class="n">ingrname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">parentname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># is this dleete the child ?</span>
        <span class="c1"># need to do the same for cylinder</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doSpheres</span><span class="p">:</span>
            <span class="n">orga</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">compartment</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Spheres_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">orga</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_Cylinders_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.clearIngr"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.clearIngr">[docs]</a>    <span class="k">def</span> <span class="nf">clearIngr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;will clear all ingredients instances but leave base parent hierarchie intact&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">loopThroughIngr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delIngr</span><span class="p">)</span></div>

    <span class="c1">#        [self.delIngr(ingrname) for ingrname in self.ingredients]</span>

<div class="viewcode-block" id="AutopackViewer.clearRecipe"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.clearRecipe">[docs]</a>    <span class="k">def</span> <span class="nf">clearRecipe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipe</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;will clear everything related to self.recipe&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">instance_dupliFace</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">recipe</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.clearAll"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.clearAll">[docs]</a>    <span class="k">def</span> <span class="nf">clearAll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipe</span><span class="p">):</span>
        <span class="c1"># shoud remove everything</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearRecipe</span><span class="p">(</span><span class="n">recipe</span><span class="p">)</span>
        <span class="c1"># reset the fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearFill</span><span class="p">(</span><span class="n">recipe</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.clearFill"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.clearFill">[docs]</a>    <span class="k">def</span> <span class="nf">clearFill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipe</span><span class="p">):</span>
        <span class="c1"># should ony reset the fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="c1">#        if self.histo.ingr_result is not None :</span>
        <span class="c1">#            self.ingredients =self.histo.ingr_result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearIngr</span><span class="p">()</span>
        <span class="c1"># need to clear also the static object</span>
        <span class="n">parentname</span> <span class="o">=</span> <span class="n">recipe</span> <span class="o">+</span> <span class="s2">&quot;static&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">parentname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">static</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">static</span><span class="p">]</span>

        <span class="c1"># need to clear also the moving object</span>
        <span class="n">parentname</span> <span class="o">=</span> <span class="n">recipe</span> <span class="o">+</span> <span class="s2">&quot;moving&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">parentname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">static</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">static</span><span class="p">]</span>

        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">recipe</span> <span class="o">+</span> <span class="s2">&quot;GridPointHider&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">point</span><span class="p">]</span></div>

<div class="viewcode-block" id="AutopackViewer.displayRoot"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayRoot">[docs]</a>    <span class="k">def</span> <span class="nf">displayRoot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">box</span><span class="p">(</span>
            <span class="s2">&quot;octreeroot&quot;</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">root</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">root</span><span class="o">.</span><span class="n">size</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">objects</span><span class="p">))</span></div>

<div class="viewcode-block" id="AutopackViewer.displaysubnode"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displaysubnode">[docs]</a>    <span class="k">def</span> <span class="nf">displaysubnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parentnode</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parentnode</span><span class="o">.</span><span class="n">hasSubnodes</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">parentnode</span><span class="o">.</span><span class="n">hasSubdivided</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">subnode</span> <span class="ow">in</span> <span class="n">parentnode</span><span class="o">.</span><span class="n">subnodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">subnode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">box</span><span class="p">(</span>
                <span class="s2">&quot;node&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                <span class="n">center</span><span class="o">=</span><span class="n">subnode</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
                <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">subnode</span><span class="o">.</span><span class="n">size</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">displaysubnode</span><span class="p">(</span><span class="n">subnode</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="AutopackViewer.displayGradient"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayGradient">[docs]</a>    <span class="k">def</span> <span class="nf">displayGradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">positions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display the given gradient as sphere at each grid position with radius = weight</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ramp</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">getRamp</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>  <span class="c1"># color</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;gradient&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;gradient&quot;</span><span class="p">)</span>
        <span class="c1"># filter only non zero value</span>
        <span class="n">gw</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">gradient</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
        <span class="c1">#        mask = distances &gt; 0.0001</span>
        <span class="c1">#        ind=numpy.nonzero(mask)[0]</span>
        <span class="c1">#        distances[ind]=cutoff</span>
        <span class="n">pindices</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">gw</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">map_colors</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">gw</span><span class="p">,</span> <span class="n">pindices</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ramp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancesSphere</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">histo</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;gradientSphere&quot;</span><span class="p">,</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">pindices</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">gw</span><span class="p">,</span> <span class="n">pindices</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
            <span class="n">colors</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.displayDistance"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.displayDistance">[docs]</a>    <span class="k">def</span> <span class="nf">displayDistance</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ramp_color1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">ramp_color2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">ramp_color3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cutoff</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distToClosestSurf</span><span class="p">[:]</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">masterGridPositions</span><span class="p">[:]</span>
        <span class="c1"># map the color as well ?</span>
        <span class="n">ramp</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">getRamp</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>  <span class="c1"># color</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">distances</span> <span class="o">&gt;</span> <span class="n">cutoff</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">distances</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">cutoff</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">distances</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">cutoff</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">distances</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">cutoff</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">upyColors</span><span class="o">.</span><span class="n">map_colors</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">ramp</span><span class="p">)</span>
        <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;distances_base&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;distances_base&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;distances&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">deleteObject</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># recursif?</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;distances&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">instancesSphere</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;distances&quot;</span><span class="p">,</span>
            <span class="n">positions</span><span class="p">,</span>
            <span class="n">distances</span><span class="p">,</span>
            <span class="n">base</span><span class="p">,</span>
            <span class="n">colors</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;distances&quot;</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.checkIngrSpheres"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.checkIngrSpheres">[docs]</a>    <span class="k">def</span> <span class="nf">checkIngrSpheres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ingr</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;Spheres&quot;</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;SpheresRep_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;SpheresRep_&quot;</span> <span class="o">+</span> <span class="n">ingr</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;S&quot;</span>
            <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">newEmpty</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orgaToMasterGeom</span><span class="p">[</span><span class="n">ingr</span><span class="p">])</span>
            <span class="n">ingr</span><span class="o">.</span><span class="n">bsph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">instancesSphere</span><span class="p">(</span>
                <span class="n">names</span><span class="p">,</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">ingr</span><span class="o">.</span><span class="n">radii</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pesph</span><span class="p">,</span>
                <span class="p">[</span><span class="n">ingr</span><span class="o">.</span><span class="n">color</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="p">,</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="AutopackViewer.checkIngrPartnerProperties"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.AutopackViewer.checkIngrPartnerProperties">[docs]</a>    <span class="k">def</span> <span class="nf">checkIngrPartnerProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingr</span><span class="p">):</span>
        <span class="n">partners</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">getPartnersName</span><span class="p">()</span>
        <span class="n">allSph</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">alternate</span> <span class="ow">in</span> <span class="n">partners</span><span class="p">:</span>
            <span class="n">pta</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">partners</span><span class="p">[</span><span class="n">alternate</span><span class="p">]</span><span class="o">.</span><span class="n">getProperties</span><span class="p">(</span><span class="s2">&quot;pt1&quot;</span><span class="p">)</span>
            <span class="n">ptb</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">partners</span><span class="p">[</span><span class="n">alternate</span><span class="p">]</span><span class="o">.</span><span class="n">getProperties</span><span class="p">(</span><span class="s2">&quot;pt2&quot;</span><span class="p">)</span>
            <span class="n">ptc</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">partners</span><span class="p">[</span><span class="n">alternate</span><span class="p">]</span><span class="o">.</span><span class="n">getProperties</span><span class="p">(</span><span class="s2">&quot;pt3&quot;</span><span class="p">)</span>
            <span class="n">ptd</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">partners</span><span class="p">[</span><span class="n">alternate</span><span class="p">]</span><span class="o">.</span><span class="n">getProperties</span><span class="p">(</span><span class="s2">&quot;pt4&quot;</span><span class="p">)</span>
            <span class="n">pte</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">partners</span><span class="p">[</span><span class="n">alternate</span><span class="p">]</span><span class="o">.</span><span class="n">getProperties</span><span class="p">(</span><span class="s2">&quot;st_pt1&quot;</span><span class="p">)</span>
            <span class="n">ptf</span> <span class="o">=</span> <span class="n">ingr</span><span class="o">.</span><span class="n">partners</span><span class="p">[</span><span class="n">alternate</span><span class="p">]</span><span class="o">.</span><span class="n">getProperties</span><span class="p">(</span><span class="s2">&quot;st_pt2&quot;</span><span class="p">)</span>
            <span class="n">allSph</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">pta</span><span class="p">,</span> <span class="n">ptb</span><span class="p">,</span> <span class="n">ptc</span><span class="p">,</span> <span class="n">ptd</span><span class="p">,</span> <span class="n">pte</span><span class="p">,</span> <span class="n">ptf</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sph</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">allSph</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sph</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="s2">&quot;sph&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">pos</span><span class="o">=</span><span class="n">sph</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ColladaExporter"><a class="viewcode-back" href="../../../cellpack.autopack.html#cellpack.autopack.Graphics.ColladaExporter">[docs]</a><span class="k">class</span> <span class="nc">ColladaExporter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span></div>
        <span class="c1"># expot from the host, then correct the instance system.</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Megan Riel-Mehan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>